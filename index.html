<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·ã‚¸ãƒ£ãƒ³ã‚±ãƒ³</title>
  <style>
    :root{
      --bg:#97d2e4;
      --ink:#0c2a33;
      --muted:#215b6b;
      --white:#fff;
      --pill:#e6f7fd;
      --btn:#10aee3;
      --btn-ink:#fff;
      --btn-ghost:#ffffff33;
      --card:#ffffffef;
      --win:#0da66e;
      --lose:#d94848;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:var(--bg);color:var(--ink);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    .wrap{min-height:100dvh;display:flex;flex-direction:column;align-items:center}
    .container{width:min(880px,92vw);margin:0 auto;padding:16px 0 24px}

    /* å…±é€šUI */
    h1{margin:8px 0 4px;font-size:clamp(22px,5.8vw,36px);letter-spacing:.06em;text-align:center}
    .sub{margin:0 0 10px;color:var(--muted);text-align:center;font-size:clamp(12px,3.4vw,15px)}
    .score{margin:12px 0 6px;text-align:center;font-weight:800;font-size:clamp(22px,7.2vw,34px)}
    .message{margin:8px 0 18px;text-align:center;font-size:clamp(14px,4.2vw,18px)}
    .pill{
      display:inline-block;padding:.45em 1em;border-radius:999px;background:var(--pill);
      font-weight:700;color:#222;font-size:clamp(12px,3.8vw,16px)
    }
    .btnrow{display:flex;gap:14px;justify-content:center;align-items:center;margin:10px 0 0}
    .btn{
      appearance:none;border:none;border-radius:14px;cursor:pointer;
      font-weight:800;letter-spacing:.06em;
      transition:transform .05s ease, box-shadow .05s ease, background .2s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn.primary{
      background:var(--btn);color:var(--btn-ink);
      padding:14px 22px; box-shadow:0 8px 24px #0592c266;
      font-size:clamp(14px,4.8vw,18px)
    }
    .btn.ghost{
      background:transparent;color:#083b48;border:2px solid #083b4840;
      padding:12px 20px;border-radius:16px;font-size:clamp(14px,4.8vw,18px)
    }

    /* ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ */
    #title{display:grid;place-items:center}
    #title .hero{width:100%;display:flex;flex-direction:column;align-items:center;gap:18px;margin-top:8px}
    #title h2{margin:0;text-align:center;line-height:1.25;
      font-size:clamp(22px,6.2vw,34px);
    }
    .title-illus{
      width:min(540px,86vw);max-height:56vh;object-fit:contain;object-position:center bottom;display:block;
      margin:8px auto 8px;
    }
    .title-note{margin:14px 0 0;text-align:center;color:#083b48aa;font-size:clamp(12px,3.6vw,15px)}
    .double{gap:18px;margin:8px 0 0}

    /* ã‚²ãƒ¼ãƒ ç”»é¢ */
    #game{display:none}
    .topRow{
      margin-top:4px;display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
    }
    .frameBox{
      position:relative;flex:0 0 auto;
      width:clamp(92px,24vw,150px);aspect-ratio:3/4;
      background:url("frame2.png") center/contain no-repeat;
    }
    .bossHand{
      position:absolute;inset:12% 12% auto 12%;
      display:grid;place-items:center;height:76%; 
      font-size:clamp(40px,12vw,68px);
      filter: drop-shadow(0 8px 14px #00000018);
    }
    .bossPic{flex:0 0 auto;width:clamp(140px,28vw,210px);height:auto;object-fit:contain}
    .hands{
      margin:14px auto 0;display:flex;justify-content:center;gap:16px;flex-wrap:nowrap;
    }
    .handBtn{
      width:clamp(84px,22vw,128px);aspect-ratio:1/1;border-radius:18px;background:var(--white);
      box-shadow:0 10px 30px #075a6a22;display:grid;place-items:center;
      font-size:clamp(30px,10vw,48px);cursor:pointer;border:none;
      transition:transform .07s ease, box-shadow .07s ease, background .2s ease;
    }
    .handBtn:active{transform:translateY(1px);box-shadow:0 6px 18px #075a6a30}
    .resultCard{
      display:none;margin:12px auto 0;max-width:720px;
      background:var(--card);border-radius:16px;padding:12px 14px;text-align:center;
      font-size:clamp(14px,4.4vw,18px);box-shadow:0 12px 28px #07495926;
    }
    .restartRow{display:none;justify-content:center;margin:14px 0 0}
    .win{color:var(--win);font-weight:800}
    .lose{color:var(--lose);font-weight:800}

    /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®è©°ã‚ */
    .container.narrow{padding-bottom:16px}
    footer{height:18px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="container" id="title">
      <div class="hero">
        <span class="pill" id="titlePill">ã‚ã¡ã‚ƒã¤ã‚ˆã£ï¼</span>
        <h2>ãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·ã¨ã®<br>ã˜ã‚ƒã‚“ã‘ã‚“å¯¾æ±ºï¼</h2>
        <img id="titleImg" class="title-illus" src="title-start2.png" alt="åº—é•·ãƒãƒ¼ã‚º">
        <div class="btnrow double">
          <button class="btn primary" id="start1">æŒ‘æˆ¦ã™ã‚‹</button>
          <button class="btn ghost"   id="start2">æŒ‘æˆ¦ã™ã‚‹</button>
        </div>
        <p class="title-note">ã‚¹ã‚¿ãƒƒãƒ•ã«å‹åˆ©ç”»é¢ã‚’è¦‹ã›ã‚‹ã¨ç‰¹å…¸ãŒã‚‚ã‚‰ãˆã‚‹ã‚ˆï¼</p>
      </div>
    </div>

    <div class="container narrow" id="game">
      <div class="topRow">
        <div class="frameBox">
          <div class="bossHand" id="bossHand">âœŠ</div>
        </div>
        <img class="bossPic" src="boss2.png" alt="åº—é•·">
      </div>

      <h1>ï½åº—é•·ã¨ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å‹è² ï½</h1>
      <p class="sub">å…ˆã«3å›å‹ã£ãŸæ–¹ãŒå‹ã¡ï¼</p>

      <div class="score" id="score">ã‚ãªãŸ 0 - åº—é•· 0</div>
      <div class="message" id="message">æ‰‹ã‚’é¸ã‚“ã§ã­ï¼</div>

      <div class="hands" id="hands">
        <button class="handBtn" data-hand="rock"     aria-label="ã‚°ãƒ¼">âœŠ</button>
        <button class="handBtn" data-hand="scissors" aria-label="ãƒãƒ§ã‚­">âœŒï¸</button>
        <button class="handBtn" data-hand="paper"    aria-label="ãƒ‘ãƒ¼">âœ‹</button>
      </div>

      <div class="resultCard" id="resultCard"></div>
      <div class="restartRow" id="restartRow">
        <button class="btn ghost" id="restartBtn">å†æŒ‘æˆ¦</button>
      </div>
    </div>

    <footer></footer>
  </div>

  <script>
    // ---------- ç”»åƒåˆ‡æ›¿ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ï¼‰ ----------
    const titleImg  = document.getElementById('titleImg');
    const titlePill = document.getElementById('titlePill');
    // ãŸã¾ã«åˆ¥ãƒãƒ¼ã‚ºã«
    function shuffleTitle(){
      if (Math.random() < 0.5) {
        titleImg.src = 'title-start2.png';
        titlePill.textContent = 'ã‚ã¡ã‚ƒã¤ã‚ˆã£ï¼';
      } else {
        titleImg.src = 'title-quit2.png';
        titlePill.textContent = 'ä¿ºã®å¼·ã•ã«æ€–æ°—ã¥ã„ãŸã‹ã£ï¼';
      }
    }
    shuffleTitle();

    // ---------- ç”»é¢åˆ‡æ›¿ ----------
    const titleView = document.getElementById('title');
    const gameView  = document.getElementById('game');
    document.getElementById('start1').onclick =
    document.getElementById('start2').onclick = () => {
      titleView.style.display = 'none';
      gameView.style.display  = 'block';
      resetGame();
      // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’å…ˆé ­ã¸
      window.scrollTo({top:0, behavior:'smooth'});
    };

    // ---------- ã‚¸ãƒ£ãƒ³ã‚±ãƒ³æœ¬ä½“ ----------
    const WIN_TARGET = 3;
    const BOSS_EDGE  = 0.55;   // åº—é•·ãŒã¡ã‚‡ã„å¼·ã„ï¼ˆ55%ã§å‹ã¡ã«æ¥ã‚‹ï¼‰

    const handsEl    = document.getElementById('hands');
    const bossHandEl = document.getElementById('bossHand');
    const scoreEl    = document.getElementById('score');
    const messageEl  = document.getElementById('message');
    const resultCard = document.getElementById('resultCard');
    const restartRow = document.getElementById('restartRow');

    let score = { you:0, boss:0 };

    const EMOJI = { rock:'âœŠ', scissors:'âœŒï¸', paper:'âœ‹' };
    const WINMAP = { rock:'scissors', scissors:'paper', paper:'rock' };

    function resetGame(){
      score.you = 0; score.boss = 0;
      updateScore();
      messageEl.textContent = 'å‹è² ã‚’é¸ã‚“ã§ã­ï¼';
      bossHandEl.textContent = 'âœŠ';
      resultCard.style.display = 'none';
      restartRow.style.display = 'none';
      handsEl.style.display = 'flex';
    }

    function updateScore(){
      scoreEl.textContent = `ã‚ãªãŸ ${score.you} - åº—é•· ${score.boss}`;
    }

    function bossPick(player){
      // åº—é•·ã¯ 55% ã§ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å‹ã¤æ‰‹ã‚’å‡ºã™
      const beat = ({rock:'paper', paper:'scissors', scissors:'rock'})[player];
      const lose = WINMAP[player];      // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå‹ã¤æ‰‹
      const tie  = player;
      if (Math.random() < BOSS_EDGE) return beat;
      // 45% ã¯ã€Œã‚ã„ã“ã€orã€Œè² ã‘ã€ã‚’åŠã€…ãã‚‰ã„ã§
      return [lose, tie][Math.random()<0.5 ? 0 : 1];
    }

    function play(player){
      if (handsEl.style.display === 'none') return; // çµ‚äº†å¾Œã¯ç„¡åŠ¹
      const boss = bossPick(player);
      bossHandEl.textContent = EMOJI[boss];

      if (player === boss){
        messageEl.textContent = 'ã‚ã„ã“ï¼æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­';
      } else if (WINMAP[player] === boss){
        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‹ã¡
        score.you++; updateScore();
        messageEl.innerHTML = `<span class="win">ã‚ãªãŸã®å‹ã¡ï¼</span> æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­`;
      } else {
        // åº—é•·ã®å‹ã¡
        score.boss++; updateScore();
        messageEl.innerHTML = `<span class="lose">åº—é•·ã®å‹ã¡ï¼</span> æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­`;
      }
      checkFinish();
    }

    function checkFinish(){
      if (score.you >= WIN_TARGET || score.boss >= WIN_TARGET){
        handsEl.style.display = 'none';
        resultCard.style.display = 'block';
        restartRow.style.display = 'flex';

        if (score.you >= WIN_TARGET){
          resultCard.innerHTML = `
            <strong>ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼</strong>
            <div style="margin-top:6px">
              ã“ã®ç”»é¢ã‚’ã‚¹ã‚¿ãƒƒãƒ•ã«è¦‹ã›ã¦ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆè²°ã£ã¦ã­ï¼
            </div>`;
        } else {
          resultCard.innerHTML = `
            <strong>ğŸ‘‘ åº—é•·ã®å‹ã¡ï¼</strong>
            <div style="margin-top:6px">ã¾ãŸæŒ‘æˆ¦ã—ã¦ã­ï¼</div>`;
        }
      }
    }

    // æ‰‹ãƒœã‚¿ãƒ³
    document.querySelectorAll('.handBtn').forEach(btn=>{
      btn.addEventListener('click', ()=> play(btn.dataset.hand));
    });
    document.getElementById('restartBtn').addEventListener('click', resetGame);

    // iOSã®ã‚»ãƒ¼ãƒ•ã‚¨ãƒªã‚¢ä½™ç™½å¯¾ç­–ï¼ˆè¦‹æ˜ ãˆï¼‰
    function fixSafeBottom(){
      document.body.style.paddingBottom = 'env(safe-area-inset-bottom, 0px)';
    }
    fixSafeBottom();
    window.addEventListener('resize', fixSafeBottom);
  </script>
</body>
</html>
