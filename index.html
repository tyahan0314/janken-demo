<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ボリューミー店長ジャンケン</title>
<style>
  :root{
    --bg:#8ecfe0;            /* 背景 */
    --panel:#ffffff;
    --ink:#10212b;
    --accent:#10b6e7;
    --accent-2:#ff8698;
  }

  /* ベース */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg);
    font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;
    color:var(--ink);
    display:flex; align-items:stretch; justify-content:center;
  }
  main{width:100%; max-width:960px; margin:auto; padding:16px 16px 80px}
  h1{
    font-size:clamp(22px, 5.6vw, 40px);
    line-height:1.2;
    margin:6px 0 12px;
    writing-mode:horizontal-tb; /* 縦書き防止 */
  }
  p, .hint {font-size:clamp(12px, 3.6vw, 16px); margin:0; opacity:.9}

  /* タイトル共通 */
  .badge{
    display:inline-block; padding:.6em 1.2em; border-radius:999px;
    background:#e6f7fd; color:#24343c; font-weight:700;
    margin:6px auto 10px;
  }
  .hero{
    display:grid; gap:18px; place-items:center;
    grid-template-rows:auto auto 1fr auto;
  }
  .hero-img{
    width:min(72vw, 440px); height:auto; object-fit:contain;
    display:block; margin:8px auto 0;
    /* ちょっと大きめに見せる */
    transform:translateY(6px);
  }
  .cta-row{
    display:flex; gap:14px; justify-content:center; margin-top:8px;
  }
  .btn{
    appearance:none; border:none; cursor:pointer;
    padding:.95em 1.6em; border-radius:14px; font-weight:800;
    font-size:clamp(15px, 4.5vw, 18px);
    box-shadow:0 8px 24px rgba(0,0,0,.08);
    transition:.15s transform ease, .15s filter ease;
    white-space:nowrap;
  }
  .btn:active{transform:translateY(1px); filter:brightness(.98)}
  .btn-primary{background:var(--accent); color:#fff}
  .btn-ghost{background:transparent; color:#0d2c36; border:3px solid #0d2c36; padding:.85em 1.4em}

  /* タイトルだけの補助テキスト */
  .title-note{ text-align:center; margin-top:12px; opacity:.9 }

  /* ゲーム画面 */
  .top-row{
    display:flex; align-items:flex-start; justify-content:space-between; gap:18px;
    margin-top:2px; margin-bottom:6px;
  }
  .boss{
    height:clamp(120px, 28vw, 240px);
    width:auto; object-fit:contain;
  }
  .frame-slot{
    position:relative;
    width:clamp(84px, 22vw, 180px); height:clamp(120px, 30vw, 240px);
    flex:0 0 auto;
  }
  .frame-slot img{position:absolute; inset:0; width:100%; height:100%; object-fit:contain}
  .hand-emoji{
    position:absolute; inset:0; display:grid; place-items:center;
    font-size:clamp(42px, 10vw, 80px);
  }

  .score{text-align:center; font-weight:900; font-size:clamp(20px, 6vw, 32px); margin:10px 0}
  .round{ text-align:center; font-size:clamp(14px,4.2vw,18px); margin:6px 0 14px }

  .choices{
    display:flex; justify-content:center; gap:16px; flex-wrap:nowrap;
    margin-top:4px;
  }
  .choice{
    width:clamp(84px, 22vw, 140px); height:clamp(70px, 18vw, 110px);
    background:#fff; border-radius:18px; display:grid; place-items:center;
    font-size:clamp(30px, 8vw, 48px); cursor:pointer; user-select:none;
    box-shadow:0 12px 30px rgba(0,0,0,.10);
    transition:transform .12s ease, box-shadow .12s ease;
  }
  .choice:active{ transform:translateY(1px); box-shadow:0 8px 18px rgba(0,0,0,.12) }

  /* 結果カード */
  .result-card{
    display:none; max-width:680px; margin:14px auto 0; padding:14px 16px;
    background:#fff; border-radius:14px; text-align:center;
    box-shadow:0 10px 24px rgba(0,0,0,.10);
  }
  .keyword{
    font-weight:900; font-size:clamp(18px,5vw,22px);
    background:#f2f7ff; padding:.35em .6em; border-radius:10px; display:inline-block;
    margin:6px 8px 8px;
  }
  .copy{ margin-left:8px; padding:.35em .8em; border-radius:10px; background:#eef; border:0; cursor:pointer }

  .center{ text-align:center; }
  .mt-12{ margin-top:12px }
  .mt-16{ margin-top:16px }
  .mt-24{ margin-top:24px }

  /* ちょいレスポンシブ微調整 */
  @media (min-width:680px){
    .top-row{ gap:24px }
    .score{ margin-top:8px }
  }
</style>
</head>
<body>
<main>

  <!-- ===== タイトル画面 ===== -->
  <section id="title" class="hero" aria-label="タイトル">
    <div class="badge" id="titleBadge">めちゃつよっ！</div>
    <h1 class="center">ボリューミー店長との<br>じゃんけん対決！</h1>
    <img id="titleImg" class="hero-img" src="title-start.png" alt="店長（挑発ポーズ）">
    <div class="cta-row">
      <button class="btn btn-primary" id="startBtn">挑戦する</button>
      <!-- 見た目は同じ、押すと“あきらめる”演出 -->
      <button class="btn btn-ghost" id="altStartBtn">挑戦する</button>
    </div>
    <div class="title-note">お店のQRからアクセス → 勝利画面を見せると特典がもらえるよ！</div>
  </section>

  <!-- ===== ゲーム画面 ===== -->
  <section id="game" hidden aria-label="ジャンケン">
    <div class="top-row">
      <div class="frame-slot">
        <img src="frame.png" alt="" aria-hidden="true">
        <div id="bossHand" class="hand-emoji">✊</div>
      </div>
      <img class="boss" src="boss.png" alt="店長">
    </div>

    <h1 class="center">〜店長とジャンケン勝負〜</h1>
    <p class="center">先に3回勝った方が勝ち！</p>

    <div id="score" class="score center">あなた 0 - 店長 0</div>
    <div id="roundMsg" class="round center">勝負を選んでね！</div>

    <div id="choices" class="choices" role="group" aria-label="手を選ぶ">
      <div class="choice" data-hand="rock" aria-label="グー">✊</div>
      <div class="choice" data-hand="scissors" aria-label="チョキ">✌️</div>
      <div class="choice" data-hand="paper" aria-label="パー">🖐️</div>
    </div>

    <!-- 勝利時 -->
    <div id="winCard" class="result-card">
      <div class="center">🎉 <b>あなたの勝ち！</b></div>
      <div class="mt-12">
        合言葉：<span class="keyword" id="kwText">ボリューミー店長</span>
        <button class="copy" id="copyKw">コピー</button>
      </div>
      <div class="hint mt-12">LINEのトークでこの合言葉を送ってね</div>
    </div>

    <!-- 敗北時 -->
    <div id="loseCard" class="result-card">
      <div class="center">👑 <b>店長の勝ち！</b> ゲーム終了！</div>
    </div>

    <div class="center mt-16">
      <button id="retryBtn" class="btn btn-ghost" hidden>再挑戦</button>
    </div>
  </section>

</main>

<script>
  // ===== タイトル画面ロジック =====
  const title = document.getElementById('title');
  const game  = document.getElementById('game');
  const titleImg   = document.getElementById('titleImg');
  const titleBadge = document.getElementById('titleBadge');
  const startBtn   = document.getElementById('startBtn');
  const altStart   = document.getElementById('altStartBtn');

  function goGame(){
    title.hidden = true;
    game.hidden  = false;
    resetGame();
  }
  startBtn.addEventListener('click', goGame);

  // ダミー「挑戦する」= あきらめる演出
  altStart.addEventListener('click', ()=>{
    titleImg.src = 'title-quit.png';
    titleImg.alt = '店長（ドヤ顔）';
    titleBadge.textContent = '俺の強さに怖気づいたかっ！';
    // 1.2秒後に本当にゲーム開始
    setTimeout(goGame, 1200);
  });

  // ===== ジャンケン本体 =====
  const scoreEl = document.getElementById('score');
  const roundMsg = document.getElementById('roundMsg');
  const bossHand = document.getElementById('bossHand');

  const choicesWrap = document.getElementById('choices');
  const winCard  = document.getElementById('winCard');
  const loseCard = document.getElementById('loseCard');
  const retryBtn = document.getElementById('retryBtn');
  const copyKw   = document.getElementById('copyKw');

  let playerScore = 0, cpuScore = 0;
  const EMOJI = { rock:'✊', scissors:'✌️', paper:'🖐️' };

  function updateScore(){
    scoreEl.textContent = `あなた ${playerScore} - 店長 ${cpuScore}`;
  }

  function cpuChoice(player){
    // 50%はランダム
    if (Math.random() < 0.5) {
      return ['rock','scissors','paper'][Math.floor(Math.random()*3)];
    }
    // 50%はプレイヤーに勝つ手
    if (player === 'rock')     return 'paper';
    if (player === 'paper')    return 'scissors';
    /* scissors の時 */        return 'rock';
  }

  function judge(player, cpu){
    if (player === cpu) return 'draw';
    if (
      (player==='rock'     && cpu==='scissors') ||
      (player==='scissors' && cpu==='paper')    ||
      (player==='paper'    && cpu==='rock')
    ) return 'win';
    return 'lose';
  }

  function endGame(who){
    choicesWrap.style.display = 'none';
    retryBtn.hidden = false;
    if (who === 'player'){
      winCard.style.display = 'block';
      loseCard.style.display = 'none';
      roundMsg.textContent = '🎉 あなたの勝ち！おめでとう！';
    } else {
      winCard.style.display = 'none';
      loseCard.style.display = 'block';
      roundMsg.textContent = '👑 店長の勝ち！また挑戦してね！';
    }
  }

  function resetGame(){
    playerScore = 0; cpuScore = 0;
    updateScore();
    bossHand.textContent = EMOJI.rock;
    roundMsg.textContent = '勝負を選んでね！';
    winCard.style.display = 'none';
    loseCard.style.display = 'none';
    retryBtn.hidden = true;
    choicesWrap.style.display = 'flex';
  }

  choicesWrap.addEventListener('click', (e)=>{
    const card = e.target.closest('.choice');
    if(!card) return;
    const player = card.dataset.hand;
    const cpu = cpuChoice(player);

    // 店長の手を表示（枠の中）
    bossHand.textContent = EMOJI[cpu];

    const r = judge(player, cpu);
    if (r === 'win'){
      playerScore++;
      roundMsg.textContent = 'あなたの勝ち！ 次の手を選んでね';
    } else if (r === 'lose'){
      cpuScore++;
      roundMsg.textContent = '店長の勝ち！ 次の手を選んでね';
    } else {
      roundMsg.textContent = 'あいこ！ もう一回！';
    }
    updateScore();

    if (playerScore >= 3) endGame('player');
    if (cpuScore    >= 3) endGame('cpu');
  });

  retryBtn.addEventListener('click', resetGame);

  copyKw.addEventListener('click', async ()=>{
    const text = 'ボリューミー店長';
    try{
      await navigator.clipboard.writeText(text);
      copyKw.textContent = 'コピー済み';
      setTimeout(()=>copyKw.textContent='コピー', 1200);
    }catch(e){
      alert('コピーできませんでした…「ボリューミー店長」を手入力で送ってね。');
    }
  });
</script>
</body>
</html>
