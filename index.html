<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ボリューミー店長じゃんけん</title>
<style>
  :root{
    --sky:#90cfe4;
    --ink:#0b2b3a;
    --card:#fff;
    --accent:#18b5d6;
    --accent-ghost:#18b5d612;
    --danger:#ff6b6b;
    --radius:16px;
    --shadow:0 10px 24px rgba(0,0,0,.12);
  }
  html,body{height:100%;}
  body{
    margin:0; background:var(--sky); color:var(--ink);
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Kaku Gothic ProN","Yu Gothic", Meiryo, sans-serif;
    -webkit-font-smoothing:antialiased; text-align:center;
  }
  .wrap{max-width:720px; margin:0 auto; padding:12px 16px 64px;}
  /* 画面切替 */
  .screen{display:none; animation:fade .18s ease;}
  .screen.active{display:block;}
  @keyframes fade{from{opacity:.001; transform:translateY(4px)} to{opacity:1; transform:none}}

  /* タイトル */
  .ribbon{
    display:inline-block; background:#fff; color:#333;
    padding:8px 18px; border-radius:999px; margin:8px 0 10px;
    font-weight:700; letter-spacing:.12em;
  }
  .title{font-size:clamp(24px,6vw,36px); line-height:1.25; margin:4px 0 8px;}
  .hero{
    position:relative; height:48vh; min-height:360px; max-height:520px;
    display:flex; align-items:flex-end; justify-content:center;
    margin:0 auto 10px; overflow:visible;
  }
  .hero img{height:100%; object-fit:contain; user-select:none; pointer-events:none;}
  .hero .start{height:min(52vh,540px);}
  .btnRow{display:flex; gap:14px; justify-content:center; margin:10px 0 6px;}
  .btn{
    appearance:none; border:0; padding:14px 22px; font-weight:800;
    border-radius:999px; box-shadow:var(--shadow); cursor:pointer;
    font-size:18px; line-height:1; transition:.12s;
  }
  .btn.primary{background:var(--accent); color:#fff;}
  .btn.ghost{background:transparent; color:var(--ink); outline:2px solid var(--ink); }
  .tiny{opacity:.8; font-size:12px; margin-top:6px;}

  /* ゲーム画面 */
  .head{
    display:flex; align-items:flex-start; justify-content:space-between; gap:16px;
    margin:8px 0 6px;
  }
  .title2{font-size:clamp(22px,5.4vw,32px); font-weight:900; margin:2px auto 2px;}
  .sub{opacity:.9; margin:0 0 8px;}

  .stage{
    position:relative; display:flex; align-items:flex-start; justify-content:space-between;
    gap:14px; margin:8px 0 8px;
  }
  /* 左：枠＋店長の手（でかめ） */
  .frameBox{position:relative; width:min(36vw,180px); height:min(36vw,180px); margin-left:4px;}
  .frameBox img.frame{position:absolute; inset:0; width:100%; height:100%; object-fit:contain;}
  .frameBox img.hand{position:absolute; inset:8% 10% 10% 10%; width:80%; height:80%; object-fit:contain;}

  /* 右：店長写真（でかめ・上寄せ） */
  .bossImg{width:min(40vw,220px); height:auto; margin-right:4px;}

  .score{font-size:clamp(22px,6.2vw,34px); font-weight:900; margin:10px 0 6px;}
  .prompt{opacity:.95; margin:0 0 10px;}

  /* 手ボタン */
  .hands{display:flex; gap:16px; justify-content:center; margin:12px 0 16px;}
  .handBtn{
    width:min(26vw,140px); height:min(18vw,96px);
    display:flex; align-items:center; justify-content:center;
    background:var(--card); border-radius:18px; box-shadow:var(--shadow);
    border:0; cursor:pointer; transition:transform .08s ease;
  }
  .handBtn:active{transform:scale(.97);}
  .handBtn img{height:64%; object-fit:contain;}
  .hidden{display:none !important;}

  /* 結果カード */
  .resultCard{
    max-width:560px; margin:12px auto 4px; background:#fff; border-radius:18px; box-shadow:var(--shadow);
    padding:16px; text-align:center;
  }
  .kw{font-weight:900; font-size:20px;}
  .copyBtn{
    margin-left:8px; padding:6px 12px; font-size:14px; border-radius:999px; border:0;
    background:var(--accent-ghost); color:var(--ink); cursor:pointer;
  }
  .again{margin-top:10px;}

  /* レスポンシブ微調整 */
  @media (max-width:360px){
    .frameBox{width:136px; height:136px;}
    .bossImg{width:164px;}
  }
</style>
</head>
<body>
  <div class="wrap">

    <!-- タイトル画面 -->
    <section id="title" class="screen active">
      <div class="ribbon">めちゃつよ！</div>
      <h1 class="title">ボリューミー店長との<br>じゃんけん対決！</h1>
      <div class="hero">
        <img src="title-start.png" alt="ボリューミー店長（挑戦待ち）" class="start">
      </div>
      <div class="btnRow">
        <button id="startBtn" class="btn primary">挑戦する</button>
        <button id="quitBtn" class="btn ghost">あきらめる</button>
      </div>
      <div class="tiny">お店のQRからアクセス→勝利画面を見せると特典がもらえるよ！</div>
    </section>

    <!-- ゲーム画面 -->
    <section id="game" class="screen">
      <div class="head">
        <div class="frameBox">
          <img class="frame" src="frame.png" alt="">
          <img id="bossHand" class="hand" src="rock.png" alt="店長の手">
        </div>
        <div style="flex:1">
          <h2 class="title2">〜店長とジャンケン勝負〜</h2>
          <p class="sub">先に3回勝った方が勝ち！</p>
        </div>
        <img class="bossImg" src="boss.png" alt="ボリューミー店長">
      </div>

      <div id="score" class="score">あなた 0 - 店長 0</div>
      <p id="prompt" class="prompt">勝負を選んでね！</p>

      <div id="handRow" class="hands">
        <button class="handBtn" data-hand="rock"     aria-label="グー"><img src="rock.png"     alt=""></button>
        <button class="handBtn" data-hand="scissors" aria-label="チョキ"><img src="scissors.png" alt=""></button>
        <button class="handBtn" data-hand="paper"    aria-label="パー"><img src="paper.png"    alt=""></button>
      </div>

      <!-- 勝利時：合言葉 / 敗北時：再挑戦 -->
      <div id="resultWin"  class="resultCard hidden">
        <div style="margin-bottom:6px; font-weight:800;">🎉 あなたの勝ち！</div>
        <div>LINEのトークでこの合言葉を送ってね</div>
        <div style="margin-top:8px;">
          <span class="kw" id="keyword">ボリューミー店長</span>
          <button id="copyBtn" class="copyBtn">コピー</button>
        </div>
        <button id="again1" class="btn primary again">もう一回！</button>
      </div>

      <div id="resultLose" class="resultCard hidden">
        <div style="margin-bottom:6px; font-weight:800;">店長の勝ち！ 💪</div>
        <div>悔しかったら再挑戦！</div>
        <button id="again2" class="btn primary again">もう一回！</button>
      </div>
    </section>
  </div>

<script>
  // 画面要素
  const $      = s => document.querySelector(s);
  const $all   = s => [...document.querySelectorAll(s)];
  const show   = el => el.classList.add('active');
  const hide   = el => el.classList.remove('active');
  const on     = (el,ev,fn)=> el.addEventListener(ev,fn);

  const scrTitle = $('#title');
  const scrGame  = $('#game');

  const bossHand = $('#bossHand');
  const scoreEl  = $('#score');
  const promptEl = $('#prompt');
  const handRow  = $('#handRow');

  const winCard  = $('#resultWin');
  const loseCard = $('#resultLose');

  const ROCK='rock', SCISSORS='scissors', PAPER='paper';
  const hands = [ROCK,SCISSORS,PAPER];
  const imgBy = { rock:'rock.png', scissors:'scissors.png', paper:'paper.png' };

  let player = 0, cpu = 0, finished = false;

  // タイトル -> ゲーム
  on($('#startBtn'),'click', ()=>{
    hide(scrTitle); show(scrGame);
    resetGame();
  });

  // あきらめる（タイトル画像を差し替えメッセージ変更）
  on($('#quitBtn'),'click', ()=>{
    $('.hero').innerHTML = '<img src="title-quit.png" alt="俺の強さに怖気づいたかっ！" class="start">';
    $('.ribbon').textContent = '俺の強さに怖気づいたかっ！';
  });

  // 手ボタン
  $all('.handBtn').forEach(btn=>{
    on(btn,'click', ()=>{
      if (finished) return;
      play(btn.dataset.hand);
    });
  });

  on($('#again1'),'click', resetGame);
  on($('#again2'),'click', resetGame);

  on($('#copyBtn'),'click', async ()=>{
    try{
      await navigator.clipboard.writeText($('#keyword').textContent.trim());
      $('#copyBtn').textContent='コピーしたよ';
      setTimeout(()=>$('#copyBtn').textContent='コピー',1200);
    }catch(e){ alert('コピーできませんでした'); }
  });

  function resetGame(){
    player = 0; cpu = 0; finished = false;
    bossHand.src = imgBy[ROCK];
    scoreEl.textContent = `あなた ${player} - 店長 ${cpu}`;
    promptEl.textContent = '勝負を選んでね！';
    handRow.classList.remove('hidden');
    winCard.classList.add('hidden');
    loseCard.classList.add('hidden');
  }

  function play(p){
    const c = cpuChoice(p);            // 店長の手
    bossHand.src = imgBy[c];

    const r = judge(p,c);
    if (r>0) player++;
    else if (r<0) cpu++;

    scoreEl.textContent = `あなた ${player} - 店長 ${cpu}`;

    if (player>=3 || cpu>=3){
      finished = true;
      handRow.classList.add('hidden');
      if (player>cpu){
        promptEl.textContent = '🎉 ゲーム終了！ あなたの勝ち！';
        winCard.classList.remove('hidden');
      }else{
        promptEl.textContent = '💀 ゲーム終了！ 店長の勝利！';
        loseCard.classList.remove('hidden');
      }
    }else{
      promptEl.textContent = '次の手を選んでね！';
    }
  }

  // 50%の確率でプレイヤーに勝つ手、残り50%はランダム
  function cpuChoice(playerHand){
    if (Math.random() < 0.5){
      return winsAgainst(playerHand);     // 勝ちに来る
    }else{
      return hands[Math.floor(Math.random()*3)];
    }
  }
  function winsAgainst(h){  // この手に勝つ手を返す
    if (h===ROCK)     return PAPER;
    if (h===SCISSORS) return ROCK;
    return SCISSORS; // paper
  }
  function judge(p,c){
    if (p===c) return 0;
    if ((p===ROCK&&c===SCISSORS)||(p===SCISSORS&&c===PAPER)||(p===PAPER&&c===ROCK)) return 1;
    return -1;
  }
</script>
</body>
</html>
