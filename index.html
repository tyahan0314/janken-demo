<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>åº—é•·ã¨ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å‹è² ï¼</title>
  <style>
    /* ===== ãƒ™ãƒ¼ã‚¹ ===== */
    :root {
      --space-top: calc(env(safe-area-inset-top) + 8px);
      --radius: 12px;
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      text-align: center;
      background: #87CEEB;
      margin: 0; padding: 0;
    }
    h1{
      margin: clamp(8px,2.6vw,16px) 0 0;
      font-size: clamp(18px,6vw,28px);
    }
    .top-note{
      margin: 4px 0 0;
      font-size: clamp(12px,3.8vw,16px);
      opacity: .9;
    }

    /* ===== å³ä¸Šï¼šåº—é•·ã€å·¦ä¸Šï¼šåº—é•·ã®æ‰‹ï¼ˆæ ï¼‰ ===== */
    #boss{
      position: fixed;
      top: var(--space-top);
      right: 10px;
      width: clamp(72px,18vw,120px);
      z-index: 5;
      user-select: none;
      -webkit-user-drag: none;
    }
    #frame{
      position: fixed;
      top: var(--space-top);
      left: 10px;
      width: clamp(84px,22vw,140px);
      height: clamp(84px,22vw,140px);
      background: url('frame.png') no-repeat center/contain;
      display: flex; align-items: center; justify-content: center;
      z-index: 4;
      user-select: none;
    }
    #cpuHand{
      width: 70%;
      height: auto;
      display: none; /* åˆæœŸã¯æ‰‹ã‚’éè¡¨ç¤ºï¼ˆæ ã ã‘ï¼‰ */
      -webkit-user-drag: none;
    }

    /* ===== ä¸­å¤®ã‚¨ãƒªã‚¢ ===== */
    #gameArea{
      min-height: 60vh;
      margin-top: clamp(120px,28vw,200px); /* ä¸Šã®å›ºå®šè¦ç´ ã¨å¹²æ¸‰ã—ãªã„ */
      display: flex; flex-direction: column;
      align-items: center; justify-content: flex-start;
      gap: clamp(8px,2.6vw,16px);
      padding: 0 12px 24px;
    }
    #score{
      font-size: clamp(16px,4.8vw,22px);
      font-weight: 700;
    }
    #result{
      font-size: clamp(14px,4.5vw,20px);
      line-height: 1.5;
      min-height: 1.5em;
    }

    /* æ‰‹ãƒœã‚¿ãƒ³ */
    #choices{ display: flex; gap: clamp(10px,4vw,16px); }
    #choices button{
      font-size: clamp(24px,8.5vw,38px);
      padding: clamp(8px,2.8vw,12px) clamp(10px,3.6vw,16px);
      border: none; border-radius: var(--radius);
      background: #fff;
      box-shadow: 0 2px 0 rgba(0,0,0,.12);
      cursor: pointer;
      transition: transform .06s ease-in-out;
    }
    #choices button:active{ transform: translateY(1px); }

    /* åˆè¨€è‘‰ãƒ»å†æŒ‘æˆ¦ */
    #keywordBox{
      display: none;
      margin-top: clamp(8px,2.8vw,12px);
      padding: clamp(8px,2.8vw,12px) clamp(12px,4vw,16px);
      background: #fff;
      border-radius: var(--radius);
      font-size: clamp(14px,4.2vw,18px);
      box-shadow: 0 2px 0 rgba(0,0,0,.08);
    }
    #keywordBox .kw-note{ margin-top: 6px; font-size: .9em; opacity: .85; }
    #copyKw{
      margin-left: 8px; padding: 6px 10px; font-size: .95em;
      border: none; border-radius: 8px; background: #efefef; cursor: pointer;
    }
    #retry{
      display: none;
      margin: clamp(10px,3vw,16px) auto 0;
      padding: clamp(10px,3vw,14px) clamp(16px,4.5vw,22px);
      font-size: clamp(14px,4.5vw,18px);
      background: #ff7f7f; color: #fff;
      border: none; border-radius: var(--radius); cursor: pointer;
    }

    /* æ¨ªå¹…ãŒåºƒã‚ã®ç«¯æœ«ã§å°‘ã—ç· ã‚ã‚‹ */
    @media (min-width: 640px){
      #gameArea{ max-width: 520px; margin-left:auto; margin-right:auto; }
    }
  </style>
</head>
<body>
  <h1>ã€œåº—é•·ã¨ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å‹è² ã€œ</h1>
  <p class="top-note">å…ˆã«3å›å‹ã£ãŸæ–¹ãŒå‹ã¡ï¼</p>

  <img id="boss" src="boss.png" alt="åº—é•·">
  <div id="frame">
    <img id="cpuHand" alt="åº—é•·ã®æ‰‹">
  </div>

  <div id="gameArea">
    <div id="score">ã‚ãªãŸ 0 - åº—é•· 0</div>
    <div id="result"></div>

    <div id="choices">
      <button onclick="play('rock')">âœŠ</button>
      <button onclick="play('scissors')">âœŒï¸</button>
      <button onclick="play('paper')">ğŸ–ï¸</button>
    </div>

    <div id="keywordBox">
      åˆè¨€è‘‰ï¼š<strong id="keywordText">ãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·</strong>
      <button id="copyKw" onclick="copyKeyword()">ã‚³ãƒ”ãƒ¼</button>
      <div class="kw-note">LINEã®ãƒˆãƒ¼ã‚¯ã§ã“ã®åˆè¨€è‘‰ã‚’é€ã£ã¦ã­</div>
    </div>

    <button id="retry" onclick="resetGame()">å†æŒ‘æˆ¦</button>
  </div>

  <script>
    /* ==== åº—é•·ã®å¼·ã•ï¼ˆå‹ã¡æ‰‹ã‚’å‡ºã™ç¢ºç‡ï¼‰ ==== */
    const BOSS_SMART_RATE = 0.75; // ä¾‹: 0.6=ã‚„ã‚„å¼±ã„ / 0.75=å¼·ã‚ / 0.85=ã‹ãªã‚Šå¼·ã„
    const KEYWORD = 'ãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·';

    /* ==== çŠ¶æ…‹ ==== */
    let playerScore = 0;
    let bossScore = 0;
    let gameOver = false;

    /* ==== åº—é•·ã®æ‰‹æ±ºå®š ==== */
    function cpuChoice(player) {
      const counter = (h) => (h === 'rock' ? 'paper' : h === 'scissors' ? 'rock' : 'scissors');
      const rnd = () => ['rock', 'scissors', 'paper'][Math.floor(Math.random() * 3)];
      return Math.random() < BOSS_SMART_RATE ? counter(player) : rnd();
    }

    /* ==== 1ã‚¿ãƒ¼ãƒ³å®Ÿè¡Œ ==== */
    function play(playerHand) {
      if (gameOver) return;

      const bossHand = cpuChoice(playerHand);
      const cpuImg = document.getElementById('cpuHand');
      cpuImg.src = bossHand + '.png';
      cpuImg.style.display = 'block';

      let result;
      if (
        (playerHand === 'rock' && bossHand === 'scissors') ||
        (playerHand === 'scissors' && bossHand === 'paper') ||
        (playerHand === 'paper' && bossHand === 'rock')
      ) {
        playerScore++; result = 'ã‚ãªãŸã®å‹ã¡ï¼';
      } else if (playerHand === bossHand) {
        result = 'ã‚ã„ã“ï¼';
      } else {
        bossScore++; result = 'åº—é•·ã®å‹ã¡ï¼';
      }

      document.getElementById('result').textContent = result;
      document.getElementById('score').textContent = `ã‚ãªãŸ ${playerScore} - åº—é•· ${bossScore}`;

      if (playerScore === 3) endGame(true);
      if (bossScore === 3) endGame(false);
    }

    /* ==== çµ‚äº†å‡¦ç† ==== */
    function endGame(playerWon) {
      gameOver = true;
      // æ‰‹ãƒœã‚¿ãƒ³ã‚’éš ã™
      document.getElementById('choices').style.display = 'none';
      // å†æŒ‘æˆ¦ãƒœã‚¿ãƒ³ã‚’å‡ºã™
      document.getElementById('retry').style.display = 'block';

      const kwBox = document.getElementById('keywordBox');
      if (playerWon) {
        document.getElementById('result').textContent = 'ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼';
        document.getElementById('keywordText').textContent = KEYWORD;
        kwBox.style.display = 'inline-block';  // åˆè¨€è‘‰ã‚’è¡¨ç¤º
      } else {
        document.getElementById('result').textContent = 'åº—é•·ã®å‹ã¡ï¼ã‚²ãƒ¼ãƒ çµ‚äº†ï¼';
        kwBox.style.display = 'none';          // è² ã‘ãªã‚‰åˆè¨€è‘‰ã¯å‡ºã•ãªã„
      }
    }

    /* ==== ãƒªã‚»ãƒƒãƒˆ ==== */
    function resetGame() {
      gameOver = false;
      playerScore = 0; bossScore = 0;
      document.getElementById('score').textContent = 'ã‚ãªãŸ 0 - åº—é•· 0';
      document.getElementById('result').textContent = '';
      document.getElementById('cpuHand').style.display = 'none';
      document.getElementById('retry').style.display = 'none';
      document.getElementById('keywordBox').style.display = 'none';
      document.getElementById('choices').style.display = 'flex';
    }

    /* ==== åˆè¨€è‘‰ã‚³ãƒ”ãƒ¼ ==== */
    function copyKeyword(){
      const btn = document.getElementById('copyKw');
      navigator.clipboard?.writeText(KEYWORD).then(()=>{
        const old = btn.textContent;
        btn.textContent = 'ã‚³ãƒ”ãƒ¼æ¸ˆã¿';
        setTimeout(()=> btn.textContent = old, 1200);
      });
    }
  </script>
</body>
</html>
