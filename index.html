<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>ã‚ã¡ã‚ƒã¤ã‚ˆãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·ã¨ã®ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å¯¾æ±º</title>

<style>
:root{
  --bg:#97d2e4; --ink:#0c2a33; --muted:#215b6b; --white:#fff;
  --pill:#e6f7fd; --btn:#10aee3; --btn-ink:#fff;
  --card:#ffffffef; --win:#0da66e; --lose:#d94848; --accent:#ff9e2c;
  --ring:#ff5a5a;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif}
.wrap{min-height:100dvh;display:flex;flex-direction:column;align-items:center}
.container{width:min(920px,94vw);margin:0 auto;padding:16px 0 24px}

/* è¦‹å‡ºã—ãªã© */
h1{margin:8px 0 6px;font-size:clamp(22px,5.8vw,36px);letter-spacing:.06em;text-align:center}
.sub{margin:0 0 10px;color:var(--muted);text-align:center;font-size:clamp(12px,3.4vw,15px)}
.pill{display:inline-block;padding:.45em 1em;border-radius:999px;background:var(--pill);
  font-weight:800;color:#1b3a46;font-size:clamp(12px,3.6vw,16px)}
.btnrow{display:flex;gap:14px;justify-content:center;align-items:center;margin:10px 0 0;flex-wrap:wrap}
.btn{appearance:none;border:none;border-radius:14px;cursor:pointer;font-weight:900;letter-spacing:.06em}
.btn.primary{background:var(--btn);color:var(--btn-ink);padding:14px 22px;font-size:clamp(14px,4.8vw,18px)}
.btn.ghost{background:transparent;color:#083b48;border:2px solid #083b4840;padding:12px 20px;border-radius:16px;font-size:clamp(14px,4.8vw,18px)}
.btn.white{background:#fff;color:#073845;border:2px solid #00000010}
.btn.orange{background:var(--accent);color:#fff;border:2px solid #0000}

/* ===== ã‚¿ã‚¤ãƒˆãƒ« ===== */
#title{display:grid;place-items:center}
.title-hero{
  width:100%;position:relative;display:flex;flex-direction:column;align-items:center;gap:10px;margin-top:0;
  background:url("bg-title.png") center/cover no-repeat;border-radius:26px;overflow:hidden;
}
.title-illus{width:min(640px,96%);max-height:66svh;object-fit:contain;object-position:center bottom;display:block;margin:0 auto;filter:drop-shadow(0 12px 32px #00000012);transform:scale(.96)} /* â† åº—é•·ã‚’å°‘ã—å°ã•ã */
#speech{display:none;margin:6px auto 10px;padding:.6em 1em;border-radius:12px;background:#fff;box-shadow:0 8px 24px rgba(0,0,0,.12);font-weight:800}

/* ===== 2048ï¼ˆè¦‹ãŸç›®ã®ã¿ï¼‰ ===== */
.scoopHud{display:flex;gap:16px;justify-content:center;align-items:center;flex-wrap:wrap;font-weight:800;margin:8px 0}
.scoopHud span{background:#ffffffcc;padding:8px 12px;border-radius:10px;box-shadow:0 6px 16px #00000012}
.scoopBtns{display:flex;gap:10px}
.scoopBoard{width:min(520px,92vw);margin:12px auto 0;position:relative}
.scGrid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;background:#bde3ef;padding:10px;border-radius:14px}
.scGrid .cell{aspect-ratio:1/1;border-radius:10px;background:#e6f7fd}
.scTiles{position:absolute;inset:0;display:grid;grid-template-columns:repeat(4,1fr);gap:10px;padding:10px}
.scTiles>.slot{aspect-ratio:1/1}
.tile{width:100%;height:100%;border-radius:12px;display:grid;place-items:center;font-weight:900;text-align:center;line-height:1.1;
  box-shadow:0 10px 24px rgba(0,0,0,.12);user-select:none;animation:tileIn .18s ease;color:#083b48;font-size:clamp(12px,3.6vw,15px)}
.tile b{display:block;font-size:clamp(18px,6vw,26px)}
@keyframes tileIn{from{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}
.tile.merge{animation:mergePop .22s ease}
@keyframes mergePop{0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)}}
.t2{background:#fffdf5}.t4{background:#fff6da}.t8{background:#ffe1e9}.t16{background:#f6d7c7}
.t32{background:#d8f0dc}.t64{background:#d7f0fb}.t128{background:#ffe9c2}.t256{background:#f7d9ff}
.t512{background:#d9fff1}.t1024{background:#fff0c5}.t2048{background:#ffe7e7}
.tileImg{width:86%;height:86%;object-fit:contain;pointer-events:none}
#scPad{position:sticky;bottom:env(safe-area-inset-bottom, 12px);display:none;margin-top:16px}
.pad{width:180px;height:160px;margin:0 auto;position:relative;display:grid;place-items:center}
.pad button{position:absolute;width:56px;height:56px;border-radius:50%;border:none;background:#ffffffd8;box-shadow:0 8px 18px #00000018;font-size:22px;font-weight:900;color:#0c2a33;cursor:pointer}
.pad .up{top:0;left:50%;transform:translate(-50%,0)} .pad .down{bottom:0;left:50%;transform:translate(-50%,0)}
.pad .left{left:0;top:50%;transform:translate(0,-50%)} .pad .right{right:0;top:50%;transform:translate(0,-50%)}

/* ===== 2äººãƒ—ãƒ¬ã‚¤å…±é€šUIï¼ˆä¸Šéƒ¨ã®é¡”ãƒãƒƒã‚¸ï¼‹ã‚¿ãƒ¼ãƒ³ï¼‰ ===== */
.duoHud{display:flex;gap:10px;justify-content:space-between;align-items:center;margin:8px auto 10px;max-width:min(820px,94vw)}
.pBadge{display:flex;align-items:center;gap:8px;background:#fff;border-radius:999px;padding:8px 14px;box-shadow:0 8px 20px #00000014;font-weight:800}
.pBadge img{width:34px;height:34px;border-radius:50%;object-fit:cover;border:3px solid transparent}
.pBadge.turn img{border-color:var(--ring)}
.turnTag{background:#ffffffd0;border:2px solid #0000;border-radius:999px;padding:8px 16px;font-weight:900}

/* ===== â—‹Ã—ï¼ˆTicTacToeï¼‰ ===== */
#ttt{display:none}
.tttBoard{width:min(620px,92vw);margin:10px auto 0;position:relative;border-radius:18px;overflow:hidden}
.tttBoard::before{content:"";position:absolute;inset:0;background:url("stage33.png") center/cover no-repeat;opacity:.25;pointer-events:none}
.tttGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;background:#7fc3da;padding:10px;border-radius:18px}
.tttCell{aspect-ratio:1/1;border-radius:14px;background:#e6f7fd;display:grid;place-items:center;cursor:pointer;box-shadow:inset 0 0 0 2px #ffffff70}
.tttCell span{font-size:clamp(34px,14vw,58px);font-weight:900;letter-spacing:.02em} /* ãƒ•ã‚©ãƒ³ãƒˆä¿®æ­£ï¼šæ—¥æœ¬èªã®ã€Œâ—‹ã€ã€ŒÃ—ã€ */
.tttCell.disabled{pointer-events:none;opacity:.8}
.resultCard{display:none;margin:12px auto 0;max-width:720px;background:var(--card);border-radius:16px;padding:12px 14px;text-align:center;font-size:clamp(14px,4.4vw,18px);box-shadow:0 12px 28px #07495926}

/* ===== å››ç›®ä¸¦ã¹ï¼ˆConnect4ï¼‰ ===== */
#c4{display:none}
.c4Wrap{width:min(820px,94vw);margin:10px auto 0;position:relative}
.c4Board{position:relative;background:#7fc3da;border-radius:18px;padding:10px;overflow:hidden}
.c4Board::before{content:"";position:absolute;inset:0;background:url("stage76.png") center/cover no-repeat;opacity:.26;pointer-events:none}
.c4Grid{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;position:relative;z-index:2}
.c4Slot{aspect-ratio:1/1;border-radius:50%;background:#e6f7fd;box-shadow:inset 0 0 0 2px #ffffff70;position:relative}
.coin{position:absolute;left:50%;transform:translate(-50%, -110%);width:72%;height:72%;object-fit:contain;filter:drop-shadow(0 10px 14px #00000020)}
@keyframes drop{from{transform:translate(-50%,-110%)}to{transform:translate(-50%, -10%)}}

/* ===== ç¥çµŒè¡°å¼±ï¼ˆ1äºº & 2äººï¼‰ ===== */
#mem1,#mem2{display:none}
.memHud{display:flex;gap:14px;justify-content:center;align-items:center;margin:10px 0 10px;font-weight:700;flex-wrap:wrap}
.memGrid{--gap:clamp(10px,3.4vw,14px);display:grid;gap:var(--gap);width:min(740px,92vw);margin:0 auto}
.memCard{aspect-ratio:1/1;perspective:1000px;position:relative}
.memInner{position:absolute;inset:0;transition:transform .42s ease;transform-style:preserve-3d;transform:rotateY(180deg)}
.memInner.flipped{transform:rotateY(0deg)}
.memFace{position:absolute;inset:0;border-radius:16px;overflow:hidden;backface-visibility:hidden;box-shadow:0 10px 24px rgba(0,0,0,.12);display:grid;place-items:center}
.memFace.front{background:#fff;transform:rotateY(0deg)}
.memFace.back{background:linear-gradient(135deg,#c9f0ff,#97d2e4);color:#084357;font-size:clamp(22px,6.4vw,28px);transform:rotateY(180deg)}
.memFace.front img{width:78%;height:78%;object-fit:contain;pointer-events:none}
.memInner.matched{animation:pop .36s ease}
@keyframes pop{0%{transform:rotateY(0deg) scale(1)}50%{transform:rotateY(0deg) scale(1.06)}100%{transform:rotateY(0deg) scale(1)}}

/* å…±é€šã®ãƒ•ãƒƒã‚¿ãƒ¼ãƒœã‚¿ãƒ³è¡Œ */
.footBtns{display:flex;gap:12px;justify-content:center;margin:14px 0 0;flex-wrap:wrap}

/* ã˜ã‚ƒã‚“ã‘ã‚“ï¼ˆç°¡ç•¥ï¼‰ */
#janken{display:none}
.topRow{margin-top:4px;display:flex;align-items:flex-start;justify-content:space-between;gap:clamp(10px,4vw,18px)}
.frameBox{position:relative;flex:0 0 auto;width:clamp(160px,40vw,320px);aspect-ratio:3/4;background:url("frame2.png") center/contain no-repeat}
.bossHandImg{position:absolute;left:8%;top:6%;width:84%;height:88%;object-fit:contain;filter:drop-shadow(0 10px 16px #00000018)}
.bossPic{flex:0 0 auto;width:clamp(200px,42vw,360px);height:auto;object-fit:contain;filter:drop-shadow(0 10px 20px rgba(0,0,0,.12))}
.hands{margin:16px auto 0;display:flex;justify-content:center;gap:clamp(12px,4vw,18px)}
.handBtn{width:clamp(92px,22vw,136px);aspect-ratio:1/1;border-radius:18px;background:var(--white);box-shadow:0 10px 30px #075a6a22;display:grid;place-items:center;font-size:clamp(34px,10vw,52px);cursor:pointer;border:none}
.win{color:var(--win);font-weight:800}.lose{color:var(--lose);font-weight:800}
</style>
</head>

<body>
<div class="wrap">

<!-- ===== ã‚¿ã‚¤ãƒˆãƒ« ===== -->
<div class="container" id="title">
  <div class="title-hero">
    <span class="pill">ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ãƒ‘ãƒ¼ã‚¯</span>
    <h1 style="margin-top:4px">ã‚ã¡ã‚ƒã¤ã‚ˆãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·ã¨ã®<br>ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å¯¾æ±º</h1>
    <img id="titleImg" class="title-illus" src="title-start2.png" alt="åº—é•·ãƒãƒ¼ã‚º">
    <div id="speech">ä¿ºã®å¼·ã•ã«æ€–æ°—ã¥ã„ãŸã‹ã£ï¼</div>

    <div class="btnrow">
      <button class="btn primary" id="btnStart">æŒ‘æˆ¦ã™ã‚‹</button>
      <button class="btn white"   id="btnQuit"  data-mode="quit">ã‚ãã‚‰ã‚ã‚‹</button>
    </div>
    <div class="btnrow">
      <button class="btn ghost"   id="btnScoop">2048ã§éŠã¶</button>
      <button class="btn orange"  id="btnDuo">2äººã§éŠã¶</button>
    </div>
    <div class="btnrow">
      <button class="btn ghost"   id="btnMem1">ç¥çµŒè¡°å¼±ï¼ˆ1äººï¼‰</button>
      <button class="btn ghost"   id="btnJanken">ã˜ã‚ƒã‚“ã‘ã‚“</button>
    </div>

    <p class="sub" style="margin:10px 0 16px">åº—é•· vs ã¿ã‚“ãªã§ã€ã‚†ã‚‹ã£ã¨å¯¾æˆ¦ï¼</p>
  </div>
</div>

<!-- ===== ã˜ã‚ƒã‚“ã‘ã‚“ ===== -->
<div class="container" id="janken">
  <div class="topRow">
    <div class="frameBox"><img id="bossHandImg" class="bossHandImg" src="rock2.png" alt=""></div>
    <img class="bossPic" src="boss2.png" alt="åº—é•·">
  </div>
  <h1>ï½åº—é•·ã¨ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å‹è² ï½</h1>
  <p class="sub">å…ˆã«3å›å‹ã£ãŸæ–¹ãŒå‹ã¡ï¼</p>
  <div class="score" id="jkScore" style="text-align:center;font-weight:900">ã‚ãªãŸ 0 - åº—é•· 0</div>
  <div class="sub" id="jkMsg">æ‰‹ã‚’é¸ã‚“ã§ã­ï¼</div>
  <div class="hands">
    <button class="handBtn" data-hand="rock">âœŠ</button>
    <button class="handBtn" data-hand="scissors">âœŒï¸</button>
    <button class="handBtn" data-hand="paper">âœ‹</button>
  </div>
  <div class="resultCard" id="jkResult"></div>
  <div class="footBtns"><button class="btn ghost" id="jkRetry">ã‚‚ã†ä¸€å›</button>
    <button class="btn ghost" id="backTitleA">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<!-- ===== 2048 ===== -->
<div class="container" id="scoop" style="display:none">
  <h1>ã€œ2048ãƒ‘ã‚ºãƒ«ã€œ</h1>
  <p class="sub">åŒã˜æ•°å­—ã‚’åˆä½“ã•ã›ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†</p>
  <div class="scoopHud">
    <span id="scScore">ã‚¹ã‚³ã‚¢: 0</span><span id="scBest">ãƒ™ã‚¹ãƒˆ: 0</span>
    <div class="scoopBtns">
      <button class="btn ghost" id="scUndo">1æ‰‹æˆ»ã‚‹</button>
      <button class="btn ghost" id="scRetry">ã‚‚ã†ä¸€å›</button>
    </div>
  </div>
  <div class="scoopBoard">
    <div class="scGrid" id="scGridBg"></div>
    <div class="scTiles" id="scTiles"></div>
  </div>
  <div class="resultCard" id="scResult" style="display:none;margin-top:14px"></div>
  <div id="scPad">
    <div class="pad">
      <button class="up">â†‘</button><button class="left">â†</button>
      <button class="right">â†’</button><button class="down">â†“</button>
    </div>
  </div>
  <div class="footBtns"><button class="btn ghost" id="scBack">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<!-- ===== 2äººï¼šã‚­ãƒ£ãƒ©é¸æŠ â†’ ã‚²ãƒ¼ãƒ é¸æŠ ===== -->
<div class="container" id="select" style="display:none">
  <h1>2äººã§éŠã¶</h1>
  <p class="sub">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ã¨2ã®ã‚­ãƒ£ãƒ©ã‚’é¸ã‚“ã§ã­ï¼ˆåŒã˜ã¯åº—é•·ã ã‘å¯ãƒ»è¡¨ç¤ºã§çŸ¥ã‚‰ã›ã¾ã›ã‚“ï¼‰</p>
  <div id="selGrid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:18px;max-width:min(820px,94vw);margin:12px auto 0">
    <div>
      <p class="pill" style="display:inline-block">P1</p>
      <div id="p1Choices" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:8px"></div>
    </div>
    <div>
      <p class="pill" style="display:inline-block">P2</p>
      <div id="p2Choices" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:8px"></div>
    </div>
  </div>
  <div class="btnrow" style="margin-top:14px"><button class="btn primary" id="goGame" disabled>ã‚²ãƒ¼ãƒ ã‚’é¸ã¶</button></div>
  <div class="btnrow"><button class="btn ghost" id="selBack">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<div class="container" id="duoMenu" style="display:none">
  <h1>ã‚²ãƒ¼ãƒ ã‚’é¸ã¶</h1>
  <p class="sub">é¸ã‚“ã ã‚­ãƒ£ãƒ©ã§å¯¾æˆ¦ï¼</p>
  <div class="btnrow">
    <button class="btn primary" id="goTTT">â—‹Ã—ã‚²ãƒ¼ãƒ </button>
  </div>
  <div class="btnrow">
    <button class="btn primary" id="goC4">ã‚³ã‚¤ãƒ³è½ã¨ã—ï¼ˆå››ç›®ä¸¦ã¹ï¼‰</button>
  </div>
  <div class="btnrow">
    <button class="btn ghost" id="goMem2">ç¥çµŒè¡°å¼±ï¼ˆ2äººï¼‰</button>
  </div>
  <div class="btnrow"><button class="btn ghost" id="reselect">ã‚­ãƒ£ãƒ©ã‚’é¸ã³ç›´ã™</button>
    <button class="btn ghost" id="menuBack">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<!-- ===== â—‹Ã— ===== -->
<div class="container" id="ttt">
  <h1>ã€œâ—‹Ã—ã‚²ãƒ¼ãƒ ã€œ</h1>
  <div class="duoHud">
    <div class="pBadge" id="tttP1"><img><span class="name">P1</span><div class="line" style="font-weight:700;color:#666"></div></div>
    <div class="turnTag" id="tttTurn">P1ã®ã‚¿ãƒ¼ãƒ³</div>
    <div class="pBadge" id="tttP2"><img><span class="name">P2</span><div class="line" style="font-weight:700;color:#666"></div></div>
  </div>
  <div class="tttBoard"><div class="tttGrid" id="tttGrid"></div></div>
  <div class="resultCard" id="tttResult"></div>
  <div class="footBtns"><button class="btn ghost" id="tttAgain">ã‚‚ã†ä¸€å›</button>
    <button class="btn ghost" id="toDuoFromTTT">ä»–ã®ã‚²ãƒ¼ãƒ ã¸</button>
    <button class="btn ghost" id="backTitleB">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<!-- ===== å››ç›®ä¸¦ã¹ ===== -->
<div class="container" id="c4">
  <h1>ã€œã‚³ã‚¤ãƒ³è½ã¨ã—ï¼ˆå››ç›®ä¸¦ã¹ï¼‰ã€œ</h1>
  <div class="duoHud">
    <div class="pBadge" id="c4P1"><img><span class="name">P1</span><div class="line" style="font-weight:700;color:#666"></div></div>
    <div class="turnTag" id="c4Turn">P1ã®ã‚¿ãƒ¼ãƒ³</div>
    <div class="pBadge" id="c4P2"><img><span class="name">P2</span><div class="line" style="font-weight:700;color:#666"></div></div>
  </div>
  <div class="c4Wrap"><div class="c4Board"><div class="c4Grid" id="c4Grid"></div></div></div>
  <div class="resultCard" id="c4Result"></div>
  <div class="footBtns"><button class="btn ghost" id="c4Again">ã‚‚ã†ä¸€å›</button>
    <button class="btn ghost" id="toDuoFromC4">ä»–ã®ã‚²ãƒ¼ãƒ ã¸</button>
    <button class="btn ghost" id="backTitleC">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<!-- ===== ç¥çµŒè¡°å¼±ï¼ˆ1äººï¼‰ ===== -->
<div class="container" id="mem1">
  <h1>ã€œç¥çµŒè¡°å¼±ï¼ˆ1äººï¼‰ã€œ</h1>
  <div class="memHud"><span id="m1Moves">æ‰‹æ•°: 0</span><button class="btn ghost" id="m1Retry">ã‚‚ã†ä¸€å›</button></div>
  <div class="memGrid" id="m1Grid"></div>
  <div class="resultCard" id="m1Result"></div>
  <div class="footBtns"><button class="btn ghost" id="backTitleD">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

<!-- ===== ç¥çµŒè¡°å¼±ï¼ˆ2äººï¼š7ãƒšã‚¢å›ºå®šï¼‰ ===== -->
<div class="container" id="mem2">
  <h1>ã€œç¥çµŒè¡°å¼±ï¼ˆ2äººï¼‰ã€œ</h1>
  <div class="duoHud">
    <div class="pBadge" id="m2P1"><img><span class="name">P1</span><div class="line" style="font-weight:700;color:#666"></div></div>
    <div class="turnTag" id="m2Turn">P1ã®ã‚¿ãƒ¼ãƒ³</div>
    <div class="pBadge" id="m2P2"><img><span class="name">P2</span><div class="line" style="font-weight:700;color:#666"></div></div>
  </div>
  <div class="memHud"><span id="m2Score">P1:0 / P2:0ï¼ˆå…¨7ãƒšã‚¢ï¼‰</span><button class="btn ghost" id="m2Retry">ã‚‚ã†ä¸€å›</button></div>
  <div class="memGrid" id="m2Grid" style="grid-template-columns:repeat(4,1fr)"></div>
  <div class="resultCard" id="m2Result"></div>
  <div class="footBtns"><button class="btn ghost" id="toDuoFromM2">ä»–ã®ã‚²ãƒ¼ãƒ ã¸</button>
    <button class="btn ghost" id="backTitleE">ã‚¿ã‚¤ãƒˆãƒ«ã¸æˆ»ã‚‹</button></div>
</div>

</div><!-- /.wrap -->

<script>
/* ===== å…±é€šï¼šç”»é¢åˆ‡æ›¿ ===== */
const views = {
  title:document.getElementById('title'),
  janken:document.getElementById('janken'),
  scoop:document.getElementById('scoop'),
  select:document.getElementById('select'),
  duoMenu:document.getElementById('duoMenu'),
  ttt:document.getElementById('ttt'),
  c4:document.getElementById('c4'),
  mem1:document.getElementById('mem1'),
  mem2:document.getElementById('mem2'),
};
function show(id){
  Object.values(views).forEach(v=>v.style.display='none');
  views[id].style.display='block';
  window.scrollTo({top:0,behavior:'smooth'});
}

/* ===== ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒœã‚¿ãƒ³ ===== */
const titleImg = document.getElementById('titleImg');
const speech   = document.getElementById('speech');
document.getElementById('btnStart').addEventListener('click', ()=>{ show('janken'); jkReset(); });
document.getElementById('btnQuit').addEventListener('click', e=>{
  const btn=e.currentTarget;
  if(btn.dataset.mode==='quit'){
    speech.style.display='block'; titleImg.src='title-quit2.png';
    btn.textContent='æŒ‘æˆ¦ã™ã‚‹'; btn.dataset.mode='start';
  }else{ show('janken'); jkReset(); }
});
document.getElementById('btnScoop').addEventListener('click', ()=>{ show('scoop'); setupScoop(); document.getElementById('scPad').style.display='block'; });
document.getElementById('btnDuo').addEventListener('click', ()=>{ show('select'); renderSelect(); });
document.getElementById('btnMem1').addEventListener('click', ()=>{ show('mem1'); m1Start(); });
document.getElementById('btnJanken').addEventListener('click', ()=>{ show('janken'); jkReset(); });

/* ======== ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å®šç¾© ======== */
const CHARS = [
  { id:'boss',   name:'åº—é•·',   avatar:'character1.png', avatar2:'character1-2.png', coin:'coin1.png', coin2:'coin1-2.png',
    win:'ä¿ºã«å‹ã¨ã†ãªã‚“ã¦100å¹´æ—©ã„ï¼', lose:'ã„ã‚„ãƒ¼ã‚“ï¼' },
  { id:'wife',   name:'å¥¥ã•ã‚“', avatar:'character2.png', coin:'coin2.png',
    win:'ä»Šæ—¥ã¯ç§ã®å‹ã¡ã­ï¼',       lose:'æ¬¡ã¯è² ã‘ãªã„ã‚ã‚ˆâ€¦' },
  { id:'part',   name:'ãƒã‚¤ãƒˆ', avatar:'character3.png', coin:'coin3.png',
    win:'ã‚„ã£ãŸã£ã™ï¼',             lose:'ãƒã‚¸ã‹â€¦' },
  { id:'ceo',    name:'ç¤¾é•·',   avatar:'character4.png', coin:'coin4.png',
    win:'ç§ãŒ1ç•ªã‚ˆï¼',               lose:'ã‚ã‚“ãŸæ¸›çµ¦ã­â€¦' },
];
let P1=null, P2=null; // {name, avatar, coin, special:'boss_winter'?}

/* ===== ã‚­ãƒ£ãƒ©é¸æŠ ===== */
function renderChoices(container, who){
  container.innerHTML='';
  CHARS.forEach(c=>{
    const card=document.createElement('button');
    card.className='btn white';
    card.style.padding='8px'; card.style.display='grid'; card.style.placeItems='center';
    card.style.borderRadius='16px';
    card.innerHTML=`<img src="${c.avatar}" alt="" style="width:82px;height:82px;object-fit:cover;border-radius:12px;display:block">
                    <div style="font-weight:900;margin-top:6px">${c.name}</div>`;
    card.addEventListener('click', ()=>{
      if(who==='P2' && P1 && P1.id!== 'boss' && c.id===P1.id){ return; } // åŒã‚­ãƒ£ãƒ©ç¦æ­¢ï¼ˆåº—é•·ä»¥å¤–ï¼‰é€šçŸ¥ãªã—
      const picked = {...c};
      if (who==='P2' && P1 && P1.id==='boss' && c.id==='boss'){
        picked.avatar = c.avatar2; picked.coin = c.coin2; picked.special='boss_winter';
      }
      if(who==='P1'){ P1=picked; } else { P2=picked; }
      checkReady();
      // P2ã‚’é¸ã‚“ã ã‚‰è‡ªå‹•ã§ã‚²ãƒ¼ãƒ é¸æŠã¸
      if (P1 && P2) { show('duoMenu'); duoHeaderInit(); bossDoubleShot(); }
    });
    container.appendChild(card);
  });
}
function renderSelect(){
  P1=P2=null; document.getElementById('goGame').disabled=true;
  renderChoices(document.getElementById('p1Choices'),'P1');
  renderChoices(document.getElementById('p2Choices'),'P2');
}
function checkReady(){ document.getElementById('goGame').disabled = !(P1&&P2); }
document.getElementById('selBack').addEventListener('click', ()=>show('title'));
document.getElementById('goGame').addEventListener('click', ()=>{ show('duoMenu'); duoHeaderInit(); bossDoubleShot(); });

/* ===== Duoãƒ¡ãƒ‹ãƒ¥ãƒ¼ ===== */
document.getElementById('goTTT').addEventListener('click', ()=>{ show('ttt'); tttStart(); });
document.getElementById('goC4').addEventListener('click',  ()=>{ show('c4');  c4Start(); });
document.getElementById('goMem2').addEventListener('click',()=>{ show('mem2'); m2Start(); });
document.getElementById('reselect').addEventListener('click', ()=>show('select'));
document.getElementById('menuBack').addEventListener('click', ()=>show('title'));

function duoHeaderInit(){
  // TTT
  ['tttP1','tttP2'].forEach((id,i)=>{
    const el=document.getElementById(id); const me=i?P2:P1;
    el.querySelector('img').src=me.avatar; el.querySelector('.name').textContent=me.name;
    el.querySelector('.line').textContent='';
  });
  // C4
  ['c4P1','c4P2'].forEach((id,i)=>{
    const el=document.getElementById(id); const me=i?P2:P1;
    el.querySelector('img').src=me.avatar; el.querySelector('.name').textContent=me.name;
    el.querySelector('.line').textContent='';
  });
  // M2
  ['m2P1','m2P2'].forEach((id,i)=>{
    const el=document.getElementById(id); const me=i?P2:P1;
    el.querySelector('img').src=me.avatar; el.querySelector('.name').textContent=me.name;
    el.querySelector('.line').textContent='';
  });
}
function bossDoubleShot(){
  if(P1&&P2&&P1.id==='boss'&&P2.id==='boss'){
    const t = document.createElement('div');
    t.style.cssText='position:fixed;inset:auto 0 18%;margin:auto;width:fit-content;padding:10px 14px;background:#fff;border-radius:12px;box-shadow:0 10px 26px #00000020;font-weight:900;text-align:center;z-index:50';
    t.textContent='ä¿ºãŒ2äººï¼ï¼Ÿ';
    document.body.appendChild(t);
    setTimeout(()=>t.remove(),1200);
  }
}

/* ===== ã‚»ãƒªãƒ•ï¼ˆè©¦åˆå¾Œã®ã¿2.5ç§’ï¼‰ ===== */
function sayLine(whereId, text){
  const el=document.getElementById(whereId).querySelector('.line');
  el.textContent=text; el.style.opacity='1';
  setTimeout(()=>{ el.style.opacity='0'; el.textContent=''; }, 2500);
}

/* ===== â—‹Ã— ===== */
const tttGrid = document.getElementById('tttGrid');
const tttTurn = document.getElementById('tttTurn');
const tttResult = document.getElementById('tttResult');
let tttBoard, tttPlayer; // 0=ç©º, 1=P1(Ã—), 2=P2(â—‹)

function tttStart(){
  tttBoard = Array(9).fill(0);
  tttPlayer = Math.random()<0.5 ? 1 : 2; // ãƒ©ãƒ³ãƒ€ãƒ å…ˆæ”»
  tttTurn.textContent = `P${tttPlayer}ã®ã‚¿ãƒ¼ãƒ³`;
  document.getElementById('tttP1').classList.toggle('turn', tttPlayer===1);
  document.getElementById('tttP2').classList.toggle('turn', tttPlayer===2);
  tttResult.style.display='none';
  tttGrid.innerHTML='';
  for(let i=0;i<9;i++){
    const c=document.createElement('div'); c.className='tttCell';
    const s=document.createElement('span'); s.textContent='';
    c.appendChild(s);
    c.addEventListener('click', ()=>{
      if(tttBoard[i]) return;
      tttBoard[i]= tttPlayer;
      s.textContent = tttPlayer===1 ? 'Ã—' : 'â—‹';
      const win = tttCheck();
      if(win){ tttFinish(win); return; }
      tttPlayer = tttPlayer===1?2:1;
      tttTurn.textContent = `P${tttPlayer}ã®ã‚¿ãƒ¼ãƒ³`;
      document.getElementById('tttP1').classList.toggle('turn', tttPlayer===1);
      document.getElementById('tttP2').classList.toggle('turn', tttPlayer===2);
    });
    tttGrid.appendChild(c);
  }
}
function tttCheck(){
  const b=tttBoard;
  const lines=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for(const [a,b1,c] of lines){ if(b[a]&&b[a]===b[b1]&&b[a]===b[c]) return b[a]; }
  if(b.every(v=>v)) return -1;
  return 0;
}
function tttFinish(who){
  Array.from(tttGrid.children).forEach(el=>el.classList.add('disabled'));
  tttResult.style.display='block';
  if(who===-1){ tttResult.innerHTML='<strong>å¼•ãåˆ†ã‘ï¼</strong>'; return; }
  const winner = who===1?P1:P2, loser = who===1?P2:P1;
  tttResult.innerHTML=`<strong>ğŸ‰ P${who}ã®å‹ã¡ï¼</strong>`;
  // ã‚»ãƒªãƒ•
  if(P1.id==='boss'&&P2.id==='boss'){
    sayLine(who===1?'tttP1':'tttP2','ä¿ºãŒæœ¬ç‰©ã®åº—é•·ã ï¼');
    sayLine(who===1?'tttP2':'tttP1','ä¿ºã«è² ã‘ãŸâ€¦');
  }else{
    sayLine(who===1?'tttP1':'tttP2', winner.win);
    sayLine(who===1?'tttP2':'tttP1', loser.lose);
  }
}
document.getElementById('tttAgain').addEventListener('click', tttStart);
document.getElementById('toDuoFromTTT').addEventListener('click', ()=>show('duoMenu'));
document.getElementById('backTitleB').addEventListener('click', ()=>show('title'));

/* ===== å››ç›®ä¸¦ã¹ï¼ˆ7x6ï¼‰ ===== */
const c4Grid = document.getElementById('c4Grid');
const c4Turn = document.getElementById('c4Turn');
const c4Result = document.getElementById('c4Result');
let c4Board, c4Player;
function c4Start(){
  c4Board = Array.from({length:6},()=>Array(7).fill(0));
  c4Player = Math.random()<0.5?1:2;
  c4Turn.textContent=`P${c4Player}ã®ã‚¿ãƒ¼ãƒ³`;
  document.getElementById('c4P1').classList.toggle('turn', c4Player===1);
  document.getElementById('c4P2').classList.toggle('turn', c4Player===2);
  c4Result.style.display='none';
  c4Grid.innerHTML='';
  for(let r=0;r<6;r++){
    for(let c=0;c<7;c++){
      const slot=document.createElement('div'); slot.className='c4Slot'; slot.dataset.col=c;
      slot.addEventListener('click', ()=>c4Drop(c));
      c4Grid.appendChild(slot);
    }
  }
}
function c4Drop(col){
  // æœ€ä¸‹æ®µã‹ã‚‰æ¢ã™
  let row=-1;
  for(let r=5;r>=0;r--){ if(!c4Board[r][col]){ row=r; break; } }
  if(row===-1) return; // æº€æ¯
  c4Board[row][col]=c4Player;

  const slot = c4Grid.children[row*7+col];
  const img=document.createElement('img'); img.className='coin';
  const me = c4Player===1?P1:P2;
  img.src = me.coin; img.style.animation='drop .22s ease forwards';
  slot.appendChild(img);

  const win=c4Check(row,col,c4Player);
  if(win){ return c4Finish(c4Player); }
  if(c4Board.every(r=>r.every(v=>v))){ c4Result.style.display='block'; c4Result.innerHTML='<strong>å¼•ãåˆ†ã‘ï¼</strong>'; return; }

  c4Player=c4Player===1?2:1;
  c4Turn.textContent=`P${c4Player}ã®ã‚¿ãƒ¼ãƒ³`;
  document.getElementById('c4P1').classList.toggle('turn', c4Player===1);
  document.getElementById('c4P2').classList.toggle('turn', c4Player===2);
}
function c4Check(r,c,p){
  const dirs=[[1,0],[0,1],[1,1],[1,-1]];
  for(const [dr,dc] of dirs){
    let count=1;
    for(let k=1;k<4;k++){ const nr=r+dr*k,nc=c+dc*k; if(nr<0||nr>5||nc<0||nc>6||c4Board[nr][nc]!==p) break; count++; }
    for(let k=1;k<4;k++){ const nr=r-dr*k,nc=c-dc*k; if(nr<0||nr>5||nc<0||nc>6||c4Board[nr][nc]!==p) break; count++; }
    if(count>=4) return true;
  }
  return false;
}
function c4Finish(who){
  c4Result.style.display='block'; c4Result.innerHTML=`<strong>ğŸ‰ P${who}ã®å‹ã¡ï¼</strong>`;
  // ã‚»ãƒªãƒ•
  if(P1.id==='boss'&&P2.id==='boss'){
    sayLine(who===1?'c4P1':'c4P2','ä¿ºãŒæœ¬ç‰©ã®åº—é•·ã ï¼');
    sayLine(who===1?'c4P2':'c4P1','ä¿ºã«è² ã‘ãŸâ€¦');
  }else{
    const winner=who===1?P1:P2, loser=who===1?P2:P1;
    sayLine(who===1?'c4P1':'c4P2', winner.win);
    sayLine(who===1?'c4P2':'c4P1', loser.lose);
  }
}
document.getElementById('c4Again').addEventListener('click', c4Start);
document.getElementById('toDuoFromC4').addEventListener('click', ()=>show('duoMenu'));
document.getElementById('backTitleC').addEventListener('click', ()=>show('title'));

/* ===== ç¥çµŒè¡°å¼±ï¼ˆ1äººï¼‰ç°¡æ˜“ ===== */
const ICE = ['ice1.png','ice2.png','ice3.png','ice4.png','ice5.png','ice6.png','ice7.png'];
function shuffled(arr){ const a=arr.slice(); for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

function m1Start(){
  const grid=document.getElementById('m1Grid'), res=document.getElementById('m1Result'), mv=document.getElementById('m1Moves');
  res.style.display='none'; let moves=0; mv.textContent='æ‰‹æ•°: 0';
  const deck=shuffled(ICE.slice(0,6).flatMap((v,i)=>[{id:i,img:v},{id:i,img:v}]));
  grid.style.gridTemplateColumns='repeat(4,1fr)'; grid.innerHTML='';
  let first=null, lock=false, matched=0;
  deck.forEach((card,idx)=>{
    const cell=document.createElement('div'); cell.className='memCard';
    const inner=document.createElement('div'); inner.className='memInner'; inner.setAttribute('role','button');
    const f=document.createElement('div'); f.className='memFace front';
    const img=document.createElement('img'); img.src=card.img; f.appendChild(img);
    const b=document.createElement('div'); b.className='memFace back'; b.textContent='ğŸ¨';
    inner.appendChild(f); inner.appendChild(b); cell.appendChild(inner); grid.appendChild(cell);
    cell.addEventListener('click', ()=>{
      if(lock||inner.classList.contains('flipped')) return;
      inner.classList.add('flipped');
      if(!first){ first={idx, id:card.id, el:inner}; return; }
      lock=true; moves++; mv.textContent=`æ‰‹æ•°: ${moves}`;
      if(first.id===card.id){
        setTimeout(()=>{ inner.classList.add('matched'); first.el.classList.add('matched'); matched++; first=null; lock=false;
          if(matched===deck.length/2){ res.style.display='block'; res.innerHTML='<strong>ğŸ‰ ãœã‚“ã¶ãã‚ã£ãŸï¼</strong>'; }
        }, 220);
      }else{
        setTimeout(()=>{ inner.classList.remove('flipped'); first.el.classList.remove('flipped'); first=null; lock=false; }, 700);
      }
    });
  });
}
document.getElementById('m1Retry').addEventListener('click', m1Start);
document.getElementById('backTitleD').addEventListener('click', ()=>show('title'));

/* ===== ç¥çµŒè¡°å¼±ï¼ˆ2äººï¼š7ãƒšã‚¢å›ºå®šï¼‰ ===== */
function m2Start(){
  const grid=document.getElementById('m2Grid'), res=document.getElementById('m2Result');
  const scoreEl=document.getElementById('m2Score'), turnTag=document.getElementById('m2Turn');
  res.style.display='none';
  let P= Math.random()<0.5 ? 1 : 2; // ãƒ©ãƒ³ãƒ€ãƒ å…ˆæ”»
  scoreEl.textContent='P1:0 / P2:0ï¼ˆå…¨7ãƒšã‚¢ï¼‰';
  turnTag.textContent=`P${P}ã®ã‚¿ãƒ¼ãƒ³`;
  document.getElementById('m2P1').classList.toggle('turn', P===1);
  document.getElementById('m2P2').classList.toggle('turn', P===2);

  const deck = shuffled(ICE.slice(0,7).flatMap((v,i)=>[{id:i,img:v},{id:i,img:v}]));
  grid.innerHTML=''; let first=null, lock=false, pairs=[0,0], matched=0;

  deck.forEach((card,idx)=>{
    const cell=document.createElement('div'); cell.className='memCard';
    const inner=document.createElement('div'); inner.className='memInner';
    const f=document.createElement('div'); f.className='memFace front'; const img=document.createElement('img'); img.src=card.img; f.appendChild(img);
    const b=document.createElement('div'); b.className='memFace back'; b.textContent='ğŸ¨';
    inner.appendChild(f); inner.appendChild(b); cell.appendChild(inner); grid.appendChild(cell);

    cell.addEventListener('click', ()=>{
      if(lock||inner.classList.contains('flipped')) return;
      inner.classList.add('flipped');
      if(!first){ first={idx,id:card.id,el:inner}; return; }

      lock=true;
      if(first.id===card.id){
        setTimeout(()=>{ inner.classList.add('matched'); first.el.classList.add('matched'); matched++; pairs[P-1]++; scoreEl.textContent=`P1:${pairs[0]} / P2:${pairs[1]}ï¼ˆå…¨7ãƒšã‚¢ï¼‰`;
          first=null; lock=false;
          // ã‚‚ã†ä¸€æ‰‹ï¼ˆåŒã˜ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç¶šè¡Œï¼‰
          if(matched===7){
            res.style.display='block';
            if(pairs[0]===pairs[1]){ res.innerHTML='<strong>å¼•ãåˆ†ã‘ï¼</strong>'; }
            else{
              const winP = pairs[0]>pairs[1]?1:2;
              res.innerHTML=`<strong>ğŸ‰ P${winP}ã®å‹ã¡ï¼</strong>`;
              // ã‚»ãƒªãƒ•
              if(P1.id==='boss'&&P2.id==='boss'){
                sayLine(winP===1?'m2P1':'m2P2','ä¿ºãŒæœ¬ç‰©ã®åº—é•·ã ï¼');
                sayLine(winP===1?'m2P2':'m2P1','ä¿ºã«è² ã‘ãŸâ€¦');
              }else{
                const winner=winP===1?P1:P2, loser=winP===1?P2:P1;
                sayLine(winP===1?'m2P1':'m2P2', winner.win);
                sayLine(winP===1?'m2P2':'m2P1', loser.lose);
              }
            }
          }
        },220);
      }else{
        setTimeout(()=>{ inner.classList.remove('flipped'); first.el.classList.remove('flipped'); first=null; lock=false;
          // ã‚¿ãƒ¼ãƒ³äº¤ä»£
          P = P===1?2:1; turnTag.textContent=`P${P}ã®ã‚¿ãƒ¼ãƒ³`;
          document.getElementById('m2P1').classList.toggle('turn', P===1);
          document.getElementById('m2P2').classList.toggle('turn', P===2);
        },700);
      }
    });
  });
}
document.getElementById('m2Retry').addEventListener('click', m2Start);
document.getElementById('toDuoFromM2').addEventListener('click', ()=>show('duoMenu'));
document.getElementById('backTitleE').addEventListener('click', ()=>show('title'));

/* ===== 2048 ãƒ­ã‚¸ãƒƒã‚¯ ===== */
const scGridBg = document.getElementById('scGridBg');
const scTiles  = document.getElementById('scTiles');
const scScore  = document.getElementById('scScore');
const scBest   = document.getElementById('scBest');
const scUndo   = document.getElementById('scUndo');
const scRetry  = document.getElementById('scRetry');
const scResult = document.getElementById('scResult');
const IMAGE_LABEL={128:'å±‹å°',256:'ã‚¢ã‚¤ã‚¹',512:'åº—é•·',1024:'åº—é•·ã‚­ãƒ¡ãƒãƒ¼ã‚º',2048:'ç¤¾é•·'};
let board=[],scoreNow=0,best=Number(localStorage.getItem('scoop_best')||0),prevState=null;
function setupScoop(){
  if(!scGridBg.childElementCount){ for(let i=0;i<16;i++){ const c=document.createElement('div'); c.className='cell'; scGridBg.appendChild(c); } }
  best=Number(localStorage.getItem('scoop_best')||0);
  scoreNow=0; board=new Array(16).fill(0); prevState=null; spawn(); spawn(); draw2048(); scResult.style.display='none';
}
function spawn(){ const zeros=board.map((v,i)=>v===0?i:null).filter(v=>v!==null); if(!zeros.length) return false; const pos=zeros[Math.floor(Math.random()*zeros.length)]; board[pos]=Math.random()<0.9?2:4; return true; }
function canMove(){ if(board.includes(0)) return true; for(let r=0;r<4;r++)for(let c=0;c<4;c++){ const i=r*4+c,v=board[i]; if(c<3&&board[i+1]===v) return true; if(r<3&&board[i+4]===v) return true; } return false; }
function lineMove(line){ let arr=line.filter(v=>v!==0),gain=0; for(let i=0;i<arr.length-1;i++){ if(arr[i]===arr[i+1]){ arr[i]*=2; gain+=arr[i]; arr[i+1]=0; i++; } } arr=arr.filter(v=>v!==0); while(arr.length<4) arr.push(0); return {line:arr,gain}; }
function move(dir){
  const before=board.slice(); prevState={board:before.slice(),score:scoreNow}; let total=0;
  if(dir==='L'||dir==='R'){ for(let r=0;r<4;r++){ let row=board.slice(r*4,r*4+4); if(dir==='R') row.reverse(); const {line,gain}=lineMove(row); total+=gain; if(dir==='R') line.reverse(); for(let c=0;c<4;c++) board[r*4+c]=line[c]; } }
  else{ for(let c=0;c<4;c++){ let col=[board[c],board[c+4],board[c+8],board[c+12]]; if(dir==='D') col.reverse(); const {line,gain}=lineMove(col); total+=gain; if(dir==='D') line.reverse(); [board[c],board[c+4],board[c+8],board[c+12]]=line; } }
  if(board.join('')===before.join('')){ prevState=null; return; }
  scoreNow+=total; if(scoreNow>best){ best=scoreNow; localStorage.setItem('scoop_best',String(best)); }
  spawn(); draw2048(); check2048();
}
function draw2048(){
  scTiles.innerHTML='';
  for(let i=0;i<16;i++){
    const slot=document.createElement('div'); slot.className='slot';
    const v=board[i];
    if(v){
      const t=document.createElement('div'); t.className=`tile t${v}`;
      if(v>=128){
        const img=document.createElement('img'); img.className='tileImg'; img.src=`puzzle${v}.png`; img.alt=IMAGE_LABEL[v]||String(v);
        img.addEventListener('error',()=>{ img.remove(); t.innerHTML=`<b>${v}</b>`; }); t.appendChild(img);
      }else{ t.innerHTML=`<b>${v}</b>`; }
      slot.appendChild(t);
    }
    scTiles.appendChild(slot);
  }
  scScore.textContent=`ã‚¹ã‚³ã‚¢: ${scoreNow}`; scBest.textContent=`ãƒ™ã‚¹ãƒˆ: ${best}`;
}
function check2048(){
  const mx=Math.max(...board);
  if(mx>=2048){ scResult.style.display='block'; scResult.innerHTML=`<strong>ğŸ‰ 2048é”æˆï¼${IMAGE_LABEL[2048]||''}</strong>`; }
  if(!canMove()){ scResult.style.display='block'; scResult.innerHTML=`<strong>ğŸ’¥ ãŠã—ã¾ã„ï¼</strong><div style="margin-top:6px">ã‚¹ã‚³ã‚¢ ${scoreNow}ï¼ˆãƒ™ã‚¹ãƒˆ ${best}ï¼‰</div>`; }
}
window.addEventListener('keydown',e=>{ if(views.scoop.style.display!=='block') return; if(e.key==='ArrowLeft')move('L'); else if(e.key==='ArrowRight')move('R'); else if(e.key==='ArrowUp')move('U'); else if(e.key==='ArrowDown')move('D'); });
let tsx=0,tsy=0;
scTiles.addEventListener('touchstart',e=>{ const t=e.touches[0]; tsx=t.clientX; tsy=t.clientY; },{passive:true});
scTiles.addEventListener('touchend',e=>{ const t=e.changedTouches[0]; const dx=t.clientX-tsx, dy=t.clientY-tsy, ax=Math.abs(dx), ay=Math.abs(dy), TH=24; if(ax<TH&&ay<TH) return; if(ax>ay) move(dx>0?'R':'L'); else move(dy>0?'D':'U'); },{passive:true});
document.querySelector('#scPad .up').addEventListener('click',()=>move('U'));
document.querySelector('#scPad .down').addEventListener('click',()=>move('D'));
document.querySelector('#scPad .left').addEventListener('click',()=>move('L'));
document.querySelector('#scPad .right').addEventListener('click',()=>move('R'));
document.getElementById('scUndo').addEventListener('click',()=>{ if(!prevState) return; board=prevState.board.slice(); scoreNow=prevState.score; prevState=null; draw2048(); scResult.style.display='none'; });
document.getElementById('scRetry').addEventListener('click', setupScoop);
document.getElementById('scBack').addEventListener('click', ()=>{ document.getElementById('scPad').style.display='none'; show('title'); });

/* ===== ã˜ã‚ƒã‚“ã‘ã‚“ ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç°¡ç•¥ï¼‰ ===== */
const jkScoreEl=document.getElementById('jkScore'), jkMsg=document.getElementById('jkMsg'), jkResult=document.getElementById('jkResult');
const bossHandImg=document.getElementById('bossHandImg'); const JKIMG={rock:'rock2.png',scissors:'scissors2.png',paper:'paper2.png'};
const WINMAP={rock:'scissors',scissors:'paper',paper:'rock'}; let jkScoreYou=0,jkScoreBoss=0; const WIN_TARGET=3, EDGE=.7;
function jkReset(){ jkScoreYou=0;jkScoreBoss=0;jkUpdate(); jkMsg.textContent='æ‰‹ã‚’é¸ã‚“ã§ã­ï¼'; jkResult.style.display='none'; bossHandImg.src=JKIMG.rock; }
function jkUpdate(){ jkScoreEl.textContent=`ã‚ãªãŸ ${jkScoreYou} - åº—é•· ${jkScoreBoss}`; }
function bossPick(p){ const beat={rock:'paper',paper:'scissors',scissors:'rock'}[p]; const lose=WINMAP[p]; const tie=p; if(Math.random()<EDGE) return beat; return Math.random()<.5?lose:tie; }
document.querySelectorAll('.handBtn').forEach(b=>b.addEventListener('click',()=>{ const p=b.dataset.hand; const boss=bossPick(p); bossHandImg.src=JKIMG[boss];
  if(p===boss){ jkMsg.textContent='ã‚ã„ã“ï¼æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­'; }
  else if(WINMAP[p]===boss){ jkScoreYou++; jkUpdate(); jkMsg.innerHTML='<span class="win">ã‚ãªãŸã®å‹ã¡ï¼</span> æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­'; }
  else{ jkScoreBoss++; jkUpdate(); jkMsg.innerHTML='<span class="lose">åº—é•·ã®å‹ã¡ï¼</span> æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­'; }
  if(jkScoreYou>=WIN_TARGET||jkScoreBoss>=WIN_TARGET){ jkResult.style.display='block'; jkResult.innerHTML = jkScoreYou>jkScoreBoss?'<strong>ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼</strong>':'<strong>ğŸ‘‘ åº—é•·ã®å‹ã¡ï¼</strong>'; }
}));
document.getElementById('jkRetry').addEventListener('click', jkReset);
document.getElementById('backTitleA').addEventListener('click', ()=>show('title'));
</script>
</body>
</html>
