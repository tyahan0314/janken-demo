<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>ãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·ãƒŸãƒ‹ã‚²ãƒ¼ãƒ </title>
<style>
  :root{
    --bg:#97d2e4; --ink:#0c2a33; --muted:#215b6b; --white:#fff;
    --pill:#e6f7fd; --btn:#10aee3; --btn-ink:#fff; --card:#ffffffef;
    --win:#0da66e; --lose:#d94848;
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--ink);
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif
  }
  .wrap{min-height:100dvh;display:flex;flex-direction:column;align-items:center}
  .container{width:min(880px,92vw);margin:0 auto;padding:16px 0 24px}

  h1{margin:8px 0 4px;font-size:clamp(22px,5.8vw,36px);letter-spacing:.06em;text-align:center}
  .sub{margin:0 0 10px;color:var(--muted);text-align:center;font-size:clamp(12px,3.4vw,15px)}
  .score{margin:12px 0 6px;text-align:center;font-weight:800;font-size:clamp(22px,7.2vw,34px)}
  .message{margin:8px 0 18px;text-align:center;font-size:clamp(14px,4.2vw,18px)}
  .pill{display:inline-block;padding:.45em 1em;border-radius:999px;background:var(--pill);
    font-weight:700;color:#222;font-size:clamp(12px,3.8vw,16px)}
  .btnrow{display:flex;gap:14px;justify-content:center;align-items:center;margin:10px 0 0;position:relative;z-index:5}
  .btn{appearance:none;border:none;border-radius:14px;cursor:pointer;font-weight:800;letter-spacing:.06em}
  .btn.primary{background:var(--btn);color:var(--btn-ink);padding:14px 22px;font-size:clamp(14px,4.8vw,18px)}
  .btn.ghost{background:transparent;color:#083b48;border:2px solid #083b4840;
    padding:12px 20px;border-radius:16px;font-size:clamp(14px,4.8vw,18px)}

  /* ===== ã‚¿ã‚¤ãƒˆãƒ« ===== */
  #title{display:grid;place-items:center}
  #title .hero{width:100%;display:flex;flex-direction:column;align-items:center;gap:12px;margin-top:8px}
  #title h2{margin:0;text-align:center;line-height:1.25;font-size:clamp(22px,6.2vw,34px)}
  .title-illus{
    width:min(620px,92vw);max-height:62svh;object-fit:contain;object-position:center bottom;
    display:block;margin:8px auto 2px; pointer-events:none;
  }
  .title-note{margin:12px 0 0;text-align:center;color:#083b48aa;font-size:clamp(12px,3.6vw,15px)}
  .speech{display:none;margin:2px auto 0;padding:.6em 1em;border-radius:12px;
    background:#fff; box-shadow:0 8px 24px rgba(0,0,0,.12); font-weight:800; text-align:center}

  /* ===== ãƒ¢ãƒ¼ãƒ‰é¸æŠ ===== */
  #mode{display:none}
  .modeBtns{display:flex;gap:16px;justify-content:center;flex-wrap:wrap;margin-top:14px}

  /* ===== ã‚¸ãƒ£ãƒ³ã‚±ãƒ³ï¼ˆå‰ã¨åŒã˜UIï¼‰ ===== */
  #game{display:none}
  .topRow{
    margin-top:4px;display:flex;align-items:flex-start;justify-content:space-between;gap:clamp(10px,4vw,18px)
  }
  .frameBox{
    position:relative;flex:0 0 auto;
    width:clamp(160px,40vw,320px);aspect-ratio:3/4;
    background:url("frame2.png") center/contain no-repeat;
  }
  .bossHandImg{
    position:absolute;left:8%;top:6%;width:84%;height:88%;
    object-fit:contain;filter:drop-shadow(0 10px 16px #00000018);
  }
  .bossPic{
    flex:0 0 auto;width:clamp(200px,42vw,360px);height:auto;object-fit:contain;
    filter:drop-shadow(0 10px 20px rgba(0,0,0,.12))
  }
  .hands{margin:16px auto 0;display:flex;justify-content:center;gap:clamp(12px,4vw,18px)}
  .handBtn{
    width:clamp(92px,22vw,136px);aspect-ratio:1/1;border-radius:18px;background:var(--white);
    box-shadow:0 10px 30px #075a6a22;display:grid;place-items:center;
    font-size:clamp(34px,10vw,52px);cursor:pointer;border:none
  }
  .resultCard{display:none;margin:12px auto 0;max-width:720px;background:var(--card);
    border-radius:16px;padding:12px 14px;text-align:center;font-size:clamp(14px,4.4vw,18px);box-shadow:0 12px 28px #07495926}
  .restartRow{display:none;justify-content:center;margin:14px 0 0}
  .win{color:var(--win);font-weight:800}.lose{color:var(--lose);font-weight:800}

  /* ===== ç¥çµŒè¡°å¼±ï¼ˆæ­£æ–¹å½¢ã‚«ãƒ¼ãƒ‰ï¼‰ ===== */
  #memory{display:none}
  .memHud{
    display:flex; gap:14px; justify-content:center; align-items:center;
    margin: 10px 0 8px; font-weight:700;
  }
  .memGrid{
    --gap: clamp(10px, 3.4vw, 14px);
    display:grid; gap: var(--gap);
    grid-template-columns: repeat(4, 1fr);
    width:min(740px, 92vw); margin: 0 auto;
  }
  .memCard{ aspect-ratio: 1 / 1; perspective: 1000px; position:relative; }
  .memInner{
    position:absolute; inset:0; transition: transform .42s ease;
    transform-style: preserve-3d; transform: rotateY(180deg); /* åˆæœŸã¯è£é¢ */
  }
  .memInner.flipped{ transform: rotateY(0deg); }           /* ã‚ãã‚‹ */
  .memFace{
    position:absolute; inset:0; border-radius:16px; overflow:hidden;
    backface-visibility:hidden; box-shadow:0 10px 24px rgba(0,0,0,.12);
    display:grid; place-items:center;
  }
  .memFace.back{
    background: linear-gradient(135deg, #c9f0ff, #97d2e4);
    color:#084357; font-size: clamp(22px, 6.4vw, 28px);
  }
  .memFace.front{
    transform: rotateY(180deg);
    background:#fff;
  }
  .memFace.front img{ width: 78%; height: 78%; object-fit: contain; pointer-events:none; }
  .memInner.matched{ animation: pop .36s ease; }
  @keyframes pop{ 0%{ transform: rotateY(0deg) scale(1)} 50%{ transform: rotateY(0deg) scale(1.06)} 100%{ transform: rotateY(0deg) scale(1)} }
</style>
</head>
<body>
  <div class="wrap">
    <!-- ===== ã‚¿ã‚¤ãƒˆãƒ« ===== -->
    <div class="container" id="title">
      <div class="hero">
        <span class="pill" id="titlePill">ã‚ã¡ã‚ƒã¤ã‚ˆã£ï¼</span> <!-- â† å¸¸ã«è¡¨ç¤º -->
        <h2>ãƒœãƒªãƒ¥ãƒ¼ãƒŸãƒ¼åº—é•·ã¨ã®<br>ã˜ã‚ƒã‚“ã‘ã‚“å¯¾æ±ºï¼</h2>
        <img id="titleImg" class="title-illus" src="title-start2.png" alt="åº—é•·ãƒãƒ¼ã‚º">
        <div id="speech" class="speech">ä¿ºã®å¼·ã•ã«æ€–æ°—ã¥ã„ãŸã‹ã£ï¼</div>
        <div class="btnrow">
          <button class="btn primary" id="btnStart">æŒ‘æˆ¦ã™ã‚‹</button>
          <button class="btn ghost"   id="btnQuit"  data-mode="quit">ã‚ãã‚‰ã‚ã‚‹</button>
        </div>
        <p class="title-note">ã‚ã¡ã‚ƒã¤ã‚ˆåº—é•·ã«å‹åˆ©ã—ã‚ˆã†ï¼</p>
      </div>
    </div>

    <!-- ===== ãƒ¢ãƒ¼ãƒ‰é¸æŠ ===== -->
    <div class="container" id="mode">
      <h1>ã‚²ãƒ¼ãƒ ã‚’é¸ã¶</h1>
      <div class="modeBtns">
        <button class="btn primary" id="modeJanken">ã‚¸ãƒ£ãƒ³ã‚±ãƒ³</button>
        <button class="btn ghost"   id="modeMemory">ç¥çµŒè¡°å¼±</button>
      </div>
    </div>

    <!-- ===== ã‚¸ãƒ£ãƒ³ã‚±ãƒ³ï¼ˆãã®ã¾ã¾ï¼‰ ===== -->
    <div class="container" id="game">
      <div class="topRow">
        <div class="frameBox">
          <img id="bossHandImg" class="bossHandImg" src="rock2.png" alt="åº—é•·ã®æ‰‹">
        </div>
        <img class="bossPic" src="boss2.png" alt="åº—é•·">
      </div>

      <h1>ï½åº—é•·ã¨ã‚¸ãƒ£ãƒ³ã‚±ãƒ³å‹è² ï½</h1>
      <p class="sub">å…ˆã«3å›å‹ã£ãŸæ–¹ãŒå‹ã¡ï¼</p>

      <div class="score" id="score">ã‚ãªãŸ 0 - åº—é•· 0</div>
      <div class="message" id="message">æ‰‹ã‚’é¸ã‚“ã§ã­ï¼</div>

      <div class="hands" id="hands">
        <button class="handBtn" data-hand="rock"     aria-label="ã‚°ãƒ¼">âœŠ</button>
        <button class="handBtn" data-hand="scissors" aria-label="ãƒãƒ§ã‚­">âœŒï¸</button>
        <button class="handBtn" data-hand="paper"    aria-label="ãƒ‘ãƒ¼">âœ‹</button>
      </div>

      <div class="resultCard" id="resultCard"></div>
      <div class="restartRow" id="restartRow">
        <button class="btn ghost" id="restartBtn">å†æŒ‘æˆ¦</button>
      </div>

      <div class="btnrow" style="margin-top:12px">
        <button class="btn ghost" id="backToMode1">ã‚²ãƒ¼ãƒ é¸æŠã¸</button>
      </div>
    </div>

    <!-- ===== ç¥çµŒè¡°å¼±ï¼ˆæ­£æ–¹å½¢ 4æŸ„Ã—2ï¼‰ ===== -->
    <div class="container" id="memory">
      <h1>ã€œç¥çµŒè¡°å¼±ã€œ</h1>
      <p class="sub">åŒã˜ã‚¢ã‚¤ã‚¹ã‚’2æšã‚ãã£ã¦ãƒšã‚¢ã‚’ä½œã‚ã†ï¼ï¼ˆå…¨4ãƒšã‚¢ï¼‰</p>

      <div class="memHud">
        <span id="memMoves">æ‰‹æ•°: 0</span>
        <span id="memPairs">ãƒšã‚¢: 0 / 4</span>
        <button class="btn ghost" id="memRetry">ã‚‚ã†ä¸€å›</button>
      </div>

      <div class="memGrid" id="memGrid" aria-label="ã‚«ãƒ¼ãƒ‰ã®å ´"></div>

      <div class="resultCard" id="memResult" style="display:none; margin-top:14px"></div>

      <div class="btnrow" style="margin-top:10px">
        <button class="btn ghost" id="memBack">ã‚²ãƒ¼ãƒ é¸æŠã¸</button>
      </div>
    </div>
  </div>

<script>
  // ===== ã‚¿ã‚¤ãƒˆãƒ«ï¼šã‚ãã‚‰ã‚ã‚‹ â†’ ã‚»ãƒªãƒ•è¡¨ç¤º & ãƒœã‚¿ãƒ³ã‚’æŒ‘æˆ¦ã«å¤‰æ›ï¼ˆ1å›ã ã‘ï¼‰ =====
  const titleView = document.getElementById('title');
  const modeView  = document.getElementById('mode');
  const gameView  = document.getElementById('game');
  const memView   = document.getElementById('memory');

  const titleImg  = document.getElementById('titleImg');
  const speech    = document.getElementById('speech');
  const btnStart  = document.getElementById('btnStart');
  const btnQuit   = document.getElementById('btnQuit');

  btnQuit.addEventListener('click', () => {
    if (btnQuit.dataset.mode === 'quit') {
      speech.style.display = 'block';
      titleImg.src = 'title-quit2.png';
      btnQuit.textContent = 'æŒ‘æˆ¦ã™ã‚‹';
      btnQuit.dataset.mode = 'start';
      btnQuit.classList.remove('ghost');
      btnQuit.classList.add('primary');
    } else {
      showMode();
    }
  });
  btnStart.addEventListener('click', showMode);

  function showMode(){
    titleView.style.display='none';
    gameView.style.display='none';
    memView.style.display='none';
    modeView.style.display='block';
    window.scrollTo({top:0, behavior:'smooth'});
  }

  // ===== ãƒ¢ãƒ¼ãƒ‰ â†’ å„ã‚²ãƒ¼ãƒ  =====
  document.getElementById('modeJanken').addEventListener('click', ()=>{
    modeView.style.display='none'; gameView.style.display='block'; resetGame();
  });
  document.getElementById('modeMemory').addEventListener('click', ()=>{
    modeView.style.display='none'; startMemory();
  });
  document.getElementById('backToMode1').addEventListener('click', showMode);

  // ===== ã‚¸ãƒ£ãƒ³ã‚±ãƒ³ï¼ˆå‰å›ã®ã¾ã¾ï¼‰ =====
  const WIN_TARGET = 3;
  const BOSS_EDGE  = 0.70; // â† ã€Œåº—é•·å¼±ã„ï¼Ÿã€ãªã‚‰ 0.70 ãã‚‰ã„ã«ä¸Šã’ã¦OK

  const scoreEl    = document.getElementById('score');
  const messageEl  = document.getElementById('message');
  const handsWrap  = document.getElementById('hands');
  const resultCard = document.getElementById('resultCard');
  const restartRow = document.getElementById('restartRow');
  const bossHandImg= document.getElementById('bossHandImg');

  let score = { you:0, boss:0 };
  const IMG    = { rock:'rock2.png', scissors:'scissors2.png', paper:'paper2.png' };
  const WINMAP = { rock:'scissors', scissors:'paper', paper:'rock' };

  function resetGame(){
    score.you = 0; score.boss = 0;
    updateScore();
    messageEl.textContent = 'æ‰‹ã‚’é¸ã‚“ã§ã­ï¼';
    bossHandImg.src = IMG.rock;
    resultCard.style.display = 'none';
    restartRow.style.display = 'none';
    handsWrap.style.display = 'flex';
  }
  function updateScore(){ scoreEl.textContent = `ã‚ãªãŸ ${score.you} - åº—é•· ${score.boss}`; }

  function bossPick(player){
    const beat = ({rock:'paper', paper:'scissors', scissors:'rock'})[player]; // åº—é•·ãŒå‹ã¤æ‰‹
    const lose = WINMAP[player]; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå‹ã¤æ‰‹
    const tie  = player;
    if (Math.random() < BOSS_EDGE) return beat;
    return [lose, tie][Math.random()<0.5 ? 0 : 1]; // ãƒ©ãƒ³ãƒ€ãƒ ï¼šè² ã‘ or ã‚ã„ã“
  }

  function play(player){
    if (handsWrap.style.display === 'none') return;
    const boss = bossPick(player);
    bossHandImg.src = IMG[boss];

    if (player === boss){
      messageEl.textContent = 'ã‚ã„ã“ï¼æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­';
    }else if (WINMAP[player] === boss){
      score.you++; updateScore();
      messageEl.innerHTML = `<span class="win">ã‚ãªãŸã®å‹ã¡ï¼</span> æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­`;
    }else{
      score.boss++; updateScore();
      messageEl.innerHTML = `<span class="lose">åº—é•·ã®å‹ã¡ï¼</span> æ¬¡ã®æ‰‹ã‚’é¸ã‚“ã§ã­`;
    }
    checkFinish();
  }

  function checkFinish(){
    if (score.you >= WIN_TARGET || score.boss >= WIN_TARGET){
      handsWrap.style.display = 'none';
      resultCard.style.display = 'block';
      restartRow.style.display = 'flex';
      if (score.you >= WIN_TARGET){
        resultCard.innerHTML = `
          <strong>ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼</strong>
          <div style="margin-top:6px">ãŠã‚ã§ã¨ã†ï¼</div>`;
      }else{
        resultCard.innerHTML = `<strong>ğŸ‘‘ åº—é•·ã®å‹ã¡ï¼</strong><div style="margin-top:6px">ã¾ãŸæŒ‘æˆ¦ã—ã¦ã­ï¼</div>`;
      }
    }
  }

  document.querySelectorAll('.handBtn').forEach(b=>b.addEventListener('click', ()=>play(b.dataset.hand)));
  document.getElementById('restartBtn').addEventListener('click', resetGame);

  // ===== ç¥çµŒè¡°å¼±ï¼ˆæ­£æ–¹å½¢ 4æŸ„Ã—2ï¼‰ =====
  const USE_ICE_IMAGES = true; // ç”»åƒã‚’ä½¿ã†ï¼ˆice1ã€œice4ï¼‰
  const ICE_SET = [
    { img:'ice1.png', emoji:'ğŸ¨', name:'ãƒ—ãƒ¬ãƒ¼ãƒ³' },
    { img:'ice2.png', emoji:'ğŸ«', name:'ãƒãƒ§ã‚³' },
    { img:'ice3.png', emoji:'ğŸµ', name:'ãã®ãèŒ¶' },
    { img:'ice4.png', emoji:'ğŸ””', name:'ã¡ã‚Šã‚“ã¡ã‚Šã‚“ãã‚“' },
  ];

  const memGrid   = document.getElementById('memGrid');
  const memMoves  = document.getElementById('memMoves');
  const memPairs  = document.getElementById('memPairs');
  const memRetry  = document.getElementById('memRetry');
  const memBack   = document.getElementById('memBack');
  const memResult = document.getElementById('memResult');

  let memDeck = []; // {id}
  let first = null, second = null, lock = false;
  let pairs = 0, moves = 0;

  function startMemory(){
    gameView.style.display='none';
    memView.style.display='block';
    buildMemDeck();
    renderMem();
    pairs = 0; moves = 0; lock = false; first = second = null;
    updateMemHud();
    memResult.style.display = 'none';
    window.scrollTo({top:0, behavior:'smooth'});
  }
  function updateMemHud(){
    memMoves.textContent = `æ‰‹æ•°: ${moves}`;
    memPairs.textContent = `ãƒšã‚¢: ${pairs} / 4`;
  }
  function buildMemDeck(){
    memDeck = [];
    for(let i=0;i<4;i++){ memDeck.push({id:i}); memDeck.push({id:i}); }
    for(let i=memDeck.length-1; i>0; i--){
      const j = Math.floor(Math.random()*(i+1));
      [memDeck[i], memDeck[j]] = [memDeck[j], memDeck[i]];
    }
  }
  function renderMem(){
    memGrid.innerHTML = '';
    memDeck.forEach((card, idx)=>{
      const c = document.createElement('div');
      c.className = 'memCard';
      c.dataset.index = idx;

      const inner = document.createElement('div');
      inner.className = 'memInner';
      inner.setAttribute('role','button');
      inner.setAttribute('aria-label','ã‚«ãƒ¼ãƒ‰ã‚’ã‚ãã‚‹');

      const front = document.createElement('div'); // è¡¨ï¼šçµµæŸ„
      front.className = 'memFace front';
      if (USE_ICE_IMAGES){
        const img = document.createElement('img');
        img.src = ICE_SET[card.id].img;
        img.alt = ICE_SET[card.id].name;
        front.appendChild(img);
      } else {
        const span = document.createElement('span');
        span.textContent = ICE_SET[card.id].emoji;
        span.style.fontSize = 'clamp(32px, 10vw, 56px)';
        front.appendChild(span);
      }

      const back = document.createElement('div'); // è£ï¼šå…±é€šãƒ‡ã‚¶ã‚¤ãƒ³
      back.className = 'memFace back';
      back.textContent = 'â„ï¸ ICE';

      inner.appendChild(front);
      inner.appendChild(back);
      c.appendChild(inner);
      memGrid.appendChild(c);

      c.addEventListener('click', ()=> flipMem(idx, inner));
    });
  }

  function flipMem(idx, innerEl){
    if (lock) return;
    if (innerEl.classList.contains('flipped')) return;

    innerEl.classList.add('flipped');
    if (!first){
      first = { idx, id: memDeck[idx].id, el: innerEl };
      navigator.vibrate?.(15);
      return;
    }
    // 2æšç›®
    second = { idx, id: memDeck[idx].id, el: innerEl };
    lock = true; moves++; updateMemHud();

    if (first.id === second.id){
      // ãƒ’ãƒƒãƒˆ
      setTimeout(()=>{
        first.el.classList.add('matched');
        second.el.classList.add('matched');
        pairs++; updateMemHud();
        first = second = null; lock = false;

        if (pairs >= 4){
          memResult.style.display = 'block';
          memResult.innerHTML = `
            <strong>ğŸ‰ ãœã‚“ã¶ãã‚ã£ãŸï¼</strong>
            <div style="margin-top:6px">ãŠã‚ã§ã¨ã†ï¼</div>`;
        }
        navigator.vibrate?.([20,40,20]);
      }, 220);
    }else{
      // ãƒŸã‚¹ï¼šå°‘ã—è¦‹ã›ã¦ã‹ã‚‰æˆ»ã™
      setTimeout(()=>{
        first.el.classList.remove('flipped');
        second.el.classList.remove('flipped');
        first = second = null; lock = false;
        navigator.vibrate?.(30);
      }, 700);
    }
  }

  memRetry.addEventListener('click', startMemory);
  memBack.addEventListener('click', showMode);
</script>
</body>
</html>
